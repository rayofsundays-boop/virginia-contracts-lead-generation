{% extends "base.html" %}

{% block title %}Pricing Guide - Subscriber Resource{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section text-center py-5" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
    <div class="container">
        <h1 class="display-2 fw-bold text-white mb-3">ðŸ’° Comprehensive Pricing Guide</h1>
        <p class="lead text-white fs-3">Win more bids with data-driven pricing strategies</p>
        <span class="badge bg-warning text-dark fs-5 px-4 py-2">Subscriber Exclusive</span>
    </div>
</div>

<div class="container my-5">
    <!-- Interactive Pricing Calculator -->
    <div class="row mb-5">
        <div class="col-lg-10 mx-auto">
            <div class="card shadow-lg border-0 mb-4">
                <div class="card-header bg-gradient text-white py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h2 class="mb-0"><i class="fas fa-calculator me-2"></i>Interactive Pricing Calculator</h2>
                    <p class="mb-0 mt-2">Build accurate, competitive bids for government cleaning contracts across all 50 states</p>
                </div>
                <div class="card-body p-4">
                    <div class="row">
                        <!-- Left Column - Inputs -->
                        <div class="col-md-6">
                            <!-- State Selection -->
                            <div class="mb-3">
                                <label for="state" class="form-label fw-bold">State</label>
                                <select class="form-select" id="state" onchange="calculatePricing()">
                                    <option value="VA" selected>Virginia</option>
                                    <option value="AL">Alabama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="DC">District of Columbia</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                            </div>

                            <!-- Metro Area -->
                            <div class="mb-3">
                                <label for="metroArea" class="form-label fw-bold">Metro Area Type</label>
                                <select class="form-select" id="metroArea" onchange="calculatePricing()">
                                    <option value="rural">Rural Area</option>
                                    <option value="suburban" selected>Suburban</option>
                                    <option value="urban">Urban</option>
                                    <option value="major_metro">Major Metro (NYC, LA, SF, DC, etc.)</option>
                                </select>
                            </div>

                            <!-- Facility Type -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Facility Type</label>
                                <select class="form-select" id="facilityType" onchange="calculatePricing()">
                                    <option value="office">Office Building</option>
                                    <option value="medical">Medical Facility</option>
                                    <option value="school">School/Educational</option>
                                    <option value="government">Government Building</option>
                                    <option value="industrial">Industrial/Warehouse</option>
                                    <option value="retail">Retail Space</option>
                                    <option value="hospitality">Hotel/Hospitality</option>
                                    <option value="datacenter">Data Center</option>
                                </select>
                            </div>

                            <!-- Square Footage -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Square Footage</label>
                                <input type="number" class="form-control" id="squareFootage" 
                                       placeholder="Enter square footage" min="0" value="10000" onchange="calculatePricing()">
                            </div>

                            <!-- Cleaning Frequency -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Cleaning Frequency</label>
                                <select class="form-select" id="frequency" onchange="calculatePricing()">
                                    <option value="daily">Daily (5x per week)</option>
                                    <option value="3x">3x per week</option>
                                    <option value="2x">2x per week</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="biweekly">Bi-weekly</option>
                                </select>
                            </div>

                            <!-- Service Level -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Service Level</label>
                                <select class="form-select" id="serviceLevel" onchange="calculatePricing()">
                                    <option value="basic">Basic (Light cleaning, trash removal)</option>
                                    <option value="standard">Standard (Vacuuming, dusting, restrooms)</option>
                                    <option value="premium">Premium (Deep cleaning, all services)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Right Column - More Inputs & Results -->
                        <div class="col-md-6">
                            <!-- Additional Services -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Additional Services (Optional)</label>
                                <small class="text-muted d-block mb-2">
                                    <i class="fas fa-info-circle me-1"></i>Check all services included in your bid. Each adds a percentage to your base price.
                                </small>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="floorCare" onchange="calculatePricing()">
                                    <label class="form-check-label small" for="floorCare">
                                        <strong>Floor Care</strong> (+15%)
                                        <span class="d-block text-muted" style="font-size: 0.85em; padding-left: 1.25rem;">Stripping, waxing, buffing</span>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="windowCleaning" onchange="calculatePricing()">
                                    <label class="form-check-label small" for="windowCleaning">
                                        <strong>Window Cleaning</strong> (+10%)
                                        <span class="d-block text-muted" style="font-size: 0.85em; padding-left: 1.25rem;">Interior/exterior glass</span>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="carpetCleaning" onchange="calculatePricing()">
                                    <label class="form-check-label small" for="carpetCleaning">
                                        <strong>Carpet Cleaning</strong> (+12%)
                                        <span class="d-block text-muted" style="font-size: 0.85em; padding-left: 1.25rem;">Deep clean, spot treatment</span>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="specializedCleaning" onchange="calculatePricing()">
                                    <label class="form-check-label small" for="specializedCleaning">
                                        <strong>Specialized/Medical Cleaning</strong> (+20%)
                                        <span class="d-block text-muted" style="font-size: 0.85em; padding-left: 1.25rem;">Biohazard, disinfection protocols</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Labor Rate -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Labor Rate (Auto-calculated)</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="laborRate" value="18.50" readonly>
                                    <span class="input-group-text">/hr</span>
                                </div>
                                <small class="text-muted" id="laborRateNote">Based on state and metro area</small>
                            </div>

                            <!-- Competition Level -->
                            <div class="mb-3">
                                <label for="competition" class="form-label fw-bold">Competition Level</label>
                                <select class="form-select" id="competition" onchange="calculatePricing()">
                                    <option value="high">High (bid lower)</option>
                                    <option value="moderate" selected>Moderate</option>
                                    <option value="low">Low (bid higher)</option>
                                </select>
                            </div>

                            <!-- Profit Margin -->
                            <div class="mb-3">
                                <label for="profitMargin" class="form-label fw-bold">Profit Margin: <span id="profitMarginValue">12</span>%</label>
                                <input type="range" class="form-range" id="profitMargin" 
                                       min="5" max="30" value="12" step="1" 
                                       oninput="document.getElementById('profitMarginValue').textContent = this.value; calculatePricing();">
                            </div>

                            <!-- Contract Duration -->
                            <div class="mb-3">
                                <label class="form-label fw-bold">Contract Duration</label>
                                <select class="form-select" id="contractDuration" onchange="calculatePricing()">
                                    <option value="1">1 Year</option>
                                    <option value="2">2 Years</option>
                                    <option value="3">3 Years</option>
                                    <option value="5">5 Years</option>
                                </select>
                            </div>

                            <!-- Calculate Button -->
                            <button class="btn btn-primary w-100" onclick="calculatePricing()">
                                <i class="fas fa-calculator me-2"></i>Calculate Pricing
                            </button>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div id="resultsSection" style="display: none;" class="mt-4">
                        <hr>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card bg-light text-center">
                                    <div class="card-body">
                                        <h6 class="text-muted mb-2">Monthly</h6>
                                        <h4 class="text-primary mb-0" id="monthlyCost">$0</h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-light text-center">
                                    <div class="card-body">
                                        <h6 class="text-muted mb-2">Annual</h6>
                                        <h4 class="text-success mb-0" id="annualCost">$0</h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-primary text-white text-center">
                                    <div class="card-body">
                                        <h6 class="mb-2">Total Contract</h6>
                                        <h4 class="mb-0" id="totalContractValue">$0</h4>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Breakdown Table -->
                        <div class="card mt-3">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Cost Breakdown</h6>
                            </div>
                            <div class="card-body p-0">
                                <table class="table table-sm mb-0">
                                    <tbody id="breakdownTable">
                                        <!-- Populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pricing Tables Section -->
    <div class="alert alert-success mb-5">
        <h4 class="alert-heading"><i class="fas fa-info-circle me-2"></i>How to Use This Guide</h4>
        <p class="mb-0">These rates are based on 2024-2025 Virginia market research including government contracts, commercial bids, and industry surveys. Adjust for your specific overhead, profit margin, and local competition.</p>
    </div>

    <!-- Office Building Rates -->
    <div class="card mb-5 shadow">
        <div class="card-header bg-primary text-white py-3">
            <h2 class="mb-0"><i class="fas fa-building me-2"></i>Office Buildings & Commercial Spaces</h2>
        </div>
        <div class="card-body">
            <h4 class="text-primary mb-3">Square Footage Rates (per sq ft/month)</h4>
            
            <div class="table-responsive">
                <table class="table table-bordered table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Building Size</th>
                            <th>Basic Service</th>
                            <th>Standard Service</th>
                            <th>Premium Service</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Under 10,000 sq ft</strong></td>
                            <td>$0.15 - $0.20</td>
                            <td>$0.20 - $0.28</td>
                            <td>$0.28 - $0.35</td>
                        </tr>
                        <tr>
                            <td><strong>10,000 - 25,000 sq ft</strong></td>
                            <td>$0.12 - $0.17</td>
                            <td>$0.17 - $0.24</td>
                            <td>$0.24 - $0.30</td>
                        </tr>
                        <tr>
                            <td><strong>25,000 - 50,000 sq ft</strong></td>
                            <td>$0.10 - $0.15</td>
                            <td>$0.15 - $0.22</td>
                            <td>$0.22 - $0.28</td>
                        </tr>
                        <tr>
                            <td><strong>50,000 - 100,000 sq ft</strong></td>
                            <td>$0.08 - $0.12</td>
                            <td>$0.12 - $0.18</td>
                            <td>$0.18 - $0.25</td>
                        </tr>
                        <tr>
                            <td><strong>Over 100,000 sq ft</strong></td>
                            <td>$0.06 - $0.10</td>
                            <td>$0.10 - $0.15</td>
                            <td>$0.15 - $0.22</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="row mt-4">
                <div class="col-md-4">
                    <div class="card bg-light">
                        <div class="card-body">
                            <h6 class="fw-bold text-primary">Basic Service Includes:</h6>
                            <ul class="small mb-0">
                                <li>Empty trash (3x/week)</li>
                                <li>Vacuum high-traffic areas</li>
                                <li>Restroom cleaning</li>
                                <li>Spot clean glass/doors</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card bg-light">
                        <div class="card-body">
                            <h6 class="fw-bold text-success">Standard Service Includes:</h6>
                            <ul class="small mb-0">
                                <li>Daily trash removal</li>
                                <li>Daily vacuum all areas</li>
                                <li>Daily restroom service</li>
                                <li>Dust surfaces</li>
                                <li>Mop hard floors</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card bg-light">
                        <div class="card-body">
                            <h6 class="fw-bold text-warning">Premium Service Includes:</h6>
                            <ul class="small mb-0">
                                <li>All standard services</li>
                                <li>Detail dusting all surfaces</li>
                                <li>High/low dusting weekly</li>
                                <li>Kitchen deep clean</li>
                                <li>Window cleaning</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Medical Facilities -->
    <div class="card mb-5 shadow">
        <div class="card-header bg-danger text-white py-3">
            <h2 class="mb-0"><i class="fas fa-hospital me-2"></i>Medical Facilities & Healthcare</h2>
        </div>
        <div class="card-body">
            <h4 class="text-danger mb-3">Specialized Healthcare Cleaning Rates</h4>
            
            <div class="alert alert-warning">
                <strong>Note:</strong> Medical facilities require specialized training, EPA-registered disinfectants, and strict protocols. Rates are 20-35% higher than standard commercial.
            </div>

            <div class="table-responsive">
                <table class="table table-bordered table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Facility Type</th>
                            <th>Rate Range (per sq ft/month)</th>
                            <th>Minimum Monthly</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Doctor's Office / Clinic</td>
                            <td>$0.25 - $0.40</td>
                            <td>$800</td>
                        </tr>
                        <tr>
                            <td>Dental Office</td>
                            <td>$0.30 - $0.45</td>
                            <td>$900</td>
                        </tr>
                        <tr>
                            <td>Urgent Care / Surgery Center</td>
                            <td>$0.35 - $0.50</td>
                            <td>$1,500</td>
                        </tr>
                        <tr>
                            <td>Hospital (Non-Patient Areas)</td>
                            <td>$0.20 - $0.35</td>
                            <td>$5,000</td>
                        </tr>
                        <tr>
                            <td>Hospital (Patient Care Areas)</td>
                            <td>$0.40 - $0.60</td>
                            <td>$10,000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Schools & Education -->
    <div class="card mb-5 shadow">
        <div class="card-header bg-info text-white py-3">
            <h2 class="mb-0"><i class="fas fa-school me-2"></i>Schools & Educational Facilities</h2>
        </div>
        <div class="card-body">
            <h4 class="text-info mb-3">Education Sector Pricing</h4>
            
            <div class="table-responsive">
                <table class="table table-bordered table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Facility Type</th>
                            <th>Daily Cleaning</th>
                            <th>3x Week</th>
                            <th>Summer Deep Clean</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Elementary School (per sq ft/month)</td>
                            <td>$0.12 - $0.18</td>
                            <td>$0.08 - $0.12</td>
                            <td>$0.05 - $0.08 (one-time)</td>
                        </tr>
                        <tr>
                            <td>Middle/High School (per sq ft/month)</td>
                            <td>$0.10 - $0.15</td>
                            <td>$0.07 - $0.10</td>
                            <td>$0.04 - $0.07 (one-time)</td>
                        </tr>
                        <tr>
                            <td>University Buildings (per sq ft/month)</td>
                            <td>$0.09 - $0.14</td>
                            <td>$0.06 - $0.09</td>
                            <td>$0.04 - $0.06 (one-time)</td>
                        </tr>
                        <tr>
                            <td>Dormitories (per sq ft/month)</td>
                            <td>$0.15 - $0.22</td>
                            <td>$0.10 - $0.15</td>
                            <td>$0.08 - $0.12 (one-time)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Labor Cost Calculator -->
    <div class="card mb-5 shadow">
        <div class="card-header bg-success text-white py-3">
            <h2 class="mb-0"><i class="fas fa-calculator me-2"></i>Labor Cost Calculator</h2>
        </div>
        <div class="card-body">
            <h4 class="text-success mb-3">How to Calculate Your Labor Costs</h4>
            
            <div class="row">
                <div class="col-md-6">
                    <h5 class="fw-bold">Virginia Cleaning Labor Rates (2024-2025)</h5>
                    <ul class="list-group mb-4">
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Entry-Level Cleaner</span>
                            <strong>$14 - $16/hour</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Experienced Cleaner</span>
                            <strong>$16 - $19/hour</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Team Lead/Supervisor</span>
                            <strong>$19 - $24/hour</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Site Manager</span>
                            <strong>$24 - $32/hour</strong>
                        </li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5 class="fw-bold">Fully Burdened Rate Formula</h5>
                    <div class="bg-light p-3 rounded">
                        <p class="mb-2"><strong>Base Wage:</strong> $16.00/hour</p>
                        <p class="mb-2"><strong>+ Payroll Taxes (7.65%):</strong> $1.22</p>
                        <p class="mb-2"><strong>+ Workers Comp (4-8%):</strong> $0.96</p>
                        <p class="mb-2"><strong>+ Benefits (15%):</strong> $2.40</p>
                        <p class="mb-2"><strong>+ Insurance/Other (5%):</strong> $0.80</p>
                        <hr>
                        <p class="mb-0 fw-bold fs-5"><strong>Fully Burdened Rate:</strong> $21.38/hour</p>
                    </div>
                </div>
            </div>

            <div class="alert alert-info mt-4">
                <h6 class="fw-bold">Industry Standard Multipliers:</h6>
                <ul class="mb-0">
                    <li><strong>Overhead Multiplier:</strong> 1.35 - 1.50 (covers management, admin, supplies)</li>
                    <li><strong>Profit Margin:</strong> 10-20% (government) | 15-25% (commercial)</li>
                    <li><strong>Example:</strong> $21.38 Ã— 1.40 overhead Ã— 1.15 profit = <strong>$34.42/hour billing rate</strong></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Specialty Services Pricing -->
    <div class="card mb-5 shadow">
        <div class="card-header bg-warning text-dark py-3">
            <h2 class="mb-0"><i class="fas fa-tools me-2"></i>Specialty Services Add-Ons</h2>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h5 class="fw-bold text-primary mb-3">Floor Care</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Strip & Wax (VCT): $0.50 - $0.75/sq ft</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Carpet Cleaning: $0.15 - $0.25/sq ft</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Tile & Grout Cleaning: $0.75 - $1.25/sq ft</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Concrete Polishing: $1.50 - $3.00/sq ft</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5 class="fw-bold text-primary mb-3">Window & Exterior</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Interior Windows: $4 - $8 per window</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Exterior Windows (ground): $6 - $12 per window</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>High-Rise Windows: $15 - $30 per window</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Pressure Washing: $0.15 - $0.40/sq ft</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Bid Strategy Guide -->
    <div class="card mb-5 shadow border-primary">
        <div class="card-header bg-primary text-white py-3">
            <h2 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Bid Strategy Guide</h2>
        </div>
        <div class="card-body">
            <h4 class="text-primary mb-3">How to Price Competitively</h4>
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="card bg-success text-white h-100">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-check-circle me-2"></i>Price Lower When:</h5>
                            <ul class="mb-0">
                                <li>You need to break into a new market</li>
                                <li>Building has economies of scale (large, simple layout)</li>
                                <li>Multiple buildings in same complex</li>
                                <li>You have excess capacity/crews</li>
                                <li>Long-term contract (3+ years)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="card bg-danger text-white h-100">
                        <div class="card-body">
                            <h5 class="card-title"><i class="fas fa-arrow-up me-2"></i>Price Higher When:</h5>
                            <ul class="mb-0">
                                <li>Specialized requirements (healthcare, labs)</li>
                                <li>After-hours or weekend work required</li>
                                <li>Complex layout or difficult access</li>
                                <li>High security clearance needed</li>
                                <li>Short-term or on-demand services</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="alert alert-warning mt-4">
                <h5 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Common Pricing Mistakes to Avoid</h5>
                <ol class="mb-0">
                    <li><strong>Underbidding:</strong> Don't go below 10% profit margin just to win</li>
                    <li><strong>Forgetting supplies:</strong> Add 3-5% for consumables</li>
                    <li><strong>No contingency:</strong> Include 5% buffer for unexpected costs</li>
                    <li><strong>Ignoring prevailing wage:</strong> Check if Davis-Bacon wages apply</li>
                    <li><strong>Not visiting site:</strong> Always walk the space before bidding</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Quick Reference Card -->
    <div class="card bg-primary text-white shadow-lg">
        <div class="card-body text-center py-4">
            <h3 class="mb-3">Quick Reference: Typical Government Contract Rates in Virginia</h3>
            <div class="row">
                <div class="col-md-3">
                    <h4 class="fw-bold">$0.10 - $0.15</h4>
                    <p class="mb-0">Large Office (100k+ sq ft)</p>
                </div>
                <div class="col-md-3">
                    <h4 class="fw-bold">$0.15 - $0.25</h4>
                    <p class="mb-0">Mid-Size Office/School</p>
                </div>
                <div class="col-md-3">
                    <h4 class="fw-bold">$0.25 - $0.40</h4>
                    <p class="mb-0">Small Office/Medical</p>
                </div>
                <div class="col-md-3">
                    <h4 class="fw-bold">$20 - $35</h4>
                    <p class="mb-0">Hourly Billing Rate</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// State cost-of-living multipliers (based on 2024 data)
const stateCostMultipliers = {
    'AL': 0.87, 'AK': 1.26, 'AZ': 0.99, 'AR': 0.86, 'CA': 1.38, 'CO': 1.05,
    'CT': 1.28, 'DE': 1.11, 'DC': 1.52, 'FL': 0.99, 'GA': 0.90, 'HI': 1.96,
    'ID': 0.97, 'IL': 1.03, 'IN': 0.89, 'IA': 0.91, 'KS': 0.89, 'KY': 0.89,
    'LA': 0.92, 'ME': 1.13, 'MD': 1.27, 'MA': 1.32, 'MI': 0.93, 'MN': 0.99,
    'MS': 0.84, 'MO': 0.88, 'MT': 1.00, 'NE': 0.91, 'NV': 1.04, 'NH': 1.16,
    'NJ': 1.29, 'NM': 0.93, 'NY': 1.39, 'NC': 0.95, 'ND': 0.98, 'OH': 0.91,
    'OK': 0.87, 'OR': 1.07, 'PA': 1.02, 'RI': 1.19, 'SC': 0.92, 'SD': 0.93,
    'TN': 0.89, 'TX': 0.93, 'UT': 0.99, 'VT': 1.15, 'VA': 1.03, 'WA': 1.15,
    'WV': 0.86, 'WI': 0.97, 'WY': 0.98
};

const metroMultipliers = {
    'rural': 0.85,
    'suburban': 1.0,
    'urban': 1.15,
    'major_metro': 1.35
};

function calculatePricing() {
    const state = document.getElementById('state').value;
    const metroArea = document.getElementById('metroArea').value;
    const facilityType = document.getElementById('facilityType').value;
    const sqft = parseFloat(document.getElementById('squareFootage').value) || 0;
    const frequency = document.getElementById('frequency').value;
    const serviceLevel = document.getElementById('serviceLevel').value;
    const competition = document.getElementById('competition').value;
    const profitMargin = parseFloat(document.getElementById('profitMargin').value) || 12;
    const contractDuration = parseInt(document.getElementById('contractDuration').value);

    // Calculate labor rate
    const nationalBaseLaborRate = 16.50;
    const stateCostMultiplier = stateCostMultipliers[state] || 1.0;
    const metroMultiplier = metroMultipliers[metroArea] || 1.0;
    const calculatedLaborRate = nationalBaseLaborRate * stateCostMultiplier * metroMultiplier;
    
    document.getElementById('laborRate').value = calculatedLaborRate.toFixed(2);
    document.getElementById('laborRateNote').textContent = `${state} ${metroArea} area`;

    // Base rate per sq ft
    let baseRatePerSqft = 0;
    switch(facilityType) {
        case 'office': baseRatePerSqft = 0.08; break;
        case 'medical': baseRatePerSqft = 0.12; break;
        case 'school': baseRatePerSqft = 0.07; break;
        case 'government': baseRatePerSqft = 0.09; break;
        case 'industrial': baseRatePerSqft = 0.06; break;
        case 'retail': baseRatePerSqft = 0.09; break;
        case 'hospitality': baseRatePerSqft = 0.11; break;
        case 'datacenter': baseRatePerSqft = 0.15; break;
    }
    baseRatePerSqft = baseRatePerSqft * stateCostMultiplier * metroMultiplier;

    // Service level
    let serviceLevelMultiplier = 1.0;
    switch(serviceLevel) {
        case 'basic': serviceLevelMultiplier = 0.75; break;
        case 'standard': serviceLevelMultiplier = 1.0; break;
        case 'premium': serviceLevelMultiplier = 1.3; break;
    }

    // Frequency
    let frequencyMultiplier = 1;
    switch(frequency) {
        case 'daily': frequencyMultiplier = 20; break;
        case '3x': frequencyMultiplier = 12; break;
        case '2x': frequencyMultiplier = 8; break;
        case 'weekly': frequencyMultiplier = 4; break;
        case 'biweekly': frequencyMultiplier = 2; break;
    }

    let baseMonthlyCost = sqft * baseRatePerSqft * serviceLevelMultiplier * frequencyMultiplier;

    // Competition
    let competitionMultiplier = 1.0;
    switch(competition) {
        case 'high': competitionMultiplier = 0.93; break;
        case 'moderate': competitionMultiplier = 1.0; break;
        case 'low': competitionMultiplier = 1.07; break;
    }
    baseMonthlyCost *= competitionMultiplier;

    // Additional services
    let additionalServicesPercent = 0;
    const breakdown = [];
    
    if (document.getElementById('floorCare')?.checked) {
        additionalServicesPercent += 15;
        breakdown.push({ name: 'Floor Care', percent: 15 });
    }
    if (document.getElementById('windowCleaning')?.checked) {
        additionalServicesPercent += 10;
        breakdown.push({ name: 'Window Cleaning', percent: 10 });
    }
    if (document.getElementById('carpetCleaning')?.checked) {
        additionalServicesPercent += 12;
        breakdown.push({ name: 'Carpet Cleaning', percent: 12 });
    }
    if (document.getElementById('specializedCleaning')?.checked) {
        additionalServicesPercent += 20;
        breakdown.push({ name: 'Specialized Cleaning', percent: 20 });
    }

    const additionalServicesCost = baseMonthlyCost * (additionalServicesPercent / 100);
    const subtotal = baseMonthlyCost + additionalServicesCost;
    const profitAmount = subtotal * (profitMargin / 100);
    const totalMonthlyCost = subtotal + profitAmount;
    const annualCost = totalMonthlyCost * 12;
    const totalContractValue = annualCost * contractDuration;

    // Display results
    document.getElementById('resultsSection').style.display = 'block';
    document.getElementById('monthlyCost').textContent = '$' + totalMonthlyCost.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    document.getElementById('annualCost').textContent = '$' + annualCost.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    document.getElementById('totalContractValue').textContent = '$' + totalContractValue.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');

    // Breakdown
    let breakdownHTML = '';
    breakdownHTML += `<tr><td>Base Cleaning</td><td class="text-end">$${baseMonthlyCost.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}/mo</td></tr>`;
    breakdown.forEach(item => {
        const cost = baseMonthlyCost * (item.percent / 100);
        breakdownHTML += `<tr><td>${item.name} (+${item.percent}%)</td><td class="text-end">$${cost.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}/mo</td></tr>`;
    });
    breakdownHTML += `<tr class="table-light"><td>Subtotal</td><td class="text-end">$${subtotal.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}</td></tr>`;
    breakdownHTML += `<tr><td>Profit (${profitMargin}%)</td><td class="text-end">$${profitAmount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}</td></tr>`;
    breakdownHTML += `<tr class="table-primary fw-bold"><td>Monthly Total</td><td class="text-end">$${totalMonthlyCost.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}</td></tr>`;
    breakdownHTML += `<tr><td colspan="2" class="text-center small text-muted">Per sq ft: $${(totalMonthlyCost/sqft).toFixed(4)}/mo</td></tr>`;
    
    document.getElementById('breakdownTable').innerHTML = breakdownHTML;
}

// Auto-calculate on page load
window.addEventListener('load', calculatePricing);
</script>

<style>
.hero-section {
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.display-2 {
    font-size: 4.5rem;
}

.table-hover tbody tr:hover {
    background-color: #f8f9fa;
    cursor: pointer;
}
</style>
{% endblock %}
