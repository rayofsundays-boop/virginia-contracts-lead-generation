{% extends "base.html" %}

{% block title %}Browse 1099 Cleaner Opportunities{% endblock %}

{% block content %}
<div class="container my-5">
    <!-- Hero Header -->
    <div class="text-center mb-5">
        <h1 class="display-5 fw-bold text-primary mb-3">
            <i class="fas fa-search me-2"></i>Browse 1099 Cleaner Opportunities
        </h1>
        <p class="lead text-muted">
            Discover contract cleaning jobs from verified companies nationwide
        </p>
    </div>

    <!-- Subscription Gate (Non-Subscribers) -->
    {% if not is_subscriber %}
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-warning">
                <div class="card-body text-center py-5">
                    <i class="fas fa-lock fa-4x text-warning mb-4"></i>
                    <h3 class="mb-3">Subscribe to Unlock Full Access</h3>
                    <p class="lead mb-4">
                        View complete job details including company names, contact information, and apply directly to opportunities.
                    </p>
                    
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <div class="card bg-light h-100">
                                <div class="card-body">
                                    <i class="fas fa-building fa-2x text-primary mb-2"></i>
                                    <h6>Company Details</h6>
                                    <p class="small mb-0">See verified company names and reputations</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light h-100">
                                <div class="card-body">
                                    <i class="fas fa-phone fa-2x text-success mb-2"></i>
                                    <h6>Direct Contact</h6>
                                    <p class="small mb-0">Access phone numbers and email addresses</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light h-100">
                                <div class="card-body">
                                    <i class="fas fa-bolt fa-2x text-warning mb-2"></i>
                                    <h6>Apply Instantly</h6>
                                    <p class="small mb-0">Respond to opportunities immediately</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <a href="/subscription" class="btn btn-warning btn-lg px-5">
                        <i class="fas fa-crown me-2"></i>Subscribe Now - $99/month
                    </a>
                    <p class="text-muted small mt-3 mb-0">
                        Cancel anytime. No long-term contracts.
                    </p>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <!-- Filters (Subscribers Only) -->
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <form method="GET" action="/browse-1099-cleaners" class="row g-3">
                <div class="col-md-3">
                    <label for="stateFilter" class="form-label fw-bold">State</label>
                    <select class="form-select" id="stateFilter" name="state" onchange="this.form.submit()">
                        <option value="">All States</option>
                        {% for state in states %}
                        <option value="{{ state }}" {% if state_filter == state %}selected{% endif %}>{{ state }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="categoryFilter" class="form-label fw-bold">Service Category</label>
                    <select class="form-select" id="categoryFilter" name="category" onchange="this.form.submit()">
                        <option value="">All Categories</option>
                        {% for cat in categories %}
                        <option value="{{ cat }}" {% if category_filter == cat %}selected{% endif %}>{{ cat }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="urgencyFilter" class="form-label fw-bold">Urgency</label>
                    <select class="form-select" id="urgencyFilter" name="urgency" onchange="this.form.submit()">
                        <option value="">All Urgencies</option>
                        <option value="urgent" {% if urgency_filter == 'urgent' %}selected{% endif %}>游댮 Urgent</option>
                        <option value="high" {% if urgency_filter == 'high' %}selected{% endif %}>游리 High</option>
                        <option value="normal" {% if urgency_filter == 'normal' %}selected{% endif %}>游릭 Normal</option>
                    </select>
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <a href="/browse-1099-cleaners" class="btn btn-outline-secondary w-100">
                        <i class="fas fa-redo me-2"></i>Clear Filters
                    </a>
                </div>
            </form>
        </div>
    </div>

    <!-- Job Listings (Subscribers Only) -->
    {% if opportunities|length == 0 %}
    <div class="text-center py-5">
        <i class="fas fa-inbox fa-4x text-muted mb-3"></i>
        <h3 class="text-muted">No Opportunities Found</h3>
        <p class="text-muted">Try adjusting your filters or check back later</p>
    </div>
    {% else %}
    <div class="row g-4">
        {% for opp in opportunities %}
        <div class="col-lg-6">
            <div class="card shadow-sm h-100">
                <div class="card-header py-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h5 class="text-white mb-0">{{ opp.title }}</h5>
                </div>
                <div class="card-body">
                    <!-- Top Row: Badges -->
                    <div class="mb-3">
                        <span class="badge bg-info me-1">{{ opp.service_category }}</span>
                        {% if opp.urgency == 'urgent' %}
                        <span class="badge bg-danger">游댮 Urgent - ASAP</span>
                        {% elif opp.urgency == 'high' %}
                        <span class="badge bg-warning text-dark">游리 High Priority</span>
                        {% else %}
                        <span class="badge bg-success">游릭 Normal</span>
                        {% endif %}
                    </div>

                    <!-- Company & Location -->
                    <h6 class="mb-3">
                        <i class="fas fa-building text-primary me-2"></i>{{ opp.company_name }}
                    </h6>
                    <p class="mb-2">
                        <i class="fas fa-map-marker-alt text-danger me-2"></i>
                        {{ opp.city }}, {{ opp.state }}
                    </p>

                    <!-- Pay Rate -->
                    <p class="mb-3">
                        <i class="fas fa-dollar-sign text-success me-2"></i>
                        <strong class="text-success">{{ opp.pay_rate }}</strong>
                    </p>

                    <!-- Description -->
                    <div class="alert alert-light border mb-3">
                        <p class="mb-0 small" style="white-space: pre-wrap;">{{ opp.description }}</p>
                    </div>

                    <!-- Requirements -->
                    <div class="mb-3">
                        {% if opp.background_check_required == 'yes' %}
                        <span class="badge bg-danger me-1">
                            <i class="fas fa-shield-alt me-1"></i>Background Check Required
                        </span>
                        {% endif %}
                        {% if opp.equipment_required == 'yes' %}
                        <span class="badge bg-success me-1">
                            <i class="fas fa-toolbox me-1"></i>Equipment Provided
                        </span>
                        {% else %}
                        <span class="badge bg-warning text-dark me-1">
                            <i class="fas fa-toolbox me-1"></i>Bring Your Own Equipment
                        </span>
                        {% endif %}
                    </div>

                    <!-- Contact Information (FULL ACCESS) -->
                    <div class="border-top pt-3">
                        <h6 class="mb-2"><i class="fas fa-address-card me-2"></i>Contact Information</h6>
                        <p class="mb-1">
                            <strong>Email:</strong> 
                            <a href="mailto:{{ opp.contact_email }}">{{ opp.contact_email }}</a>
                        </p>
                        <p class="mb-0">
                            <strong>Phone:</strong> 
                            <a href="tel:{{ opp.contact_phone }}">{{ opp.contact_phone }}</a>
                        </p>
                    </div>
                </div>
                <div class="card-footer text-muted small">
                    <i class="fas fa-calendar me-1"></i>Posted {{ opp.created_at[:10] }}
                    <span class="ms-3"><i class="fas fa-eye me-1"></i>{{ opp.views }} views</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endif %}

    <!-- CTA to Post Job -->
    <div class="card shadow-lg border-0 mt-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <div class="card-body text-white text-center py-4">
            <h4 class="mb-2">Looking to Hire 1099 Cleaners?</h4>
            <p class="mb-3">Post your cleaning job for FREE and connect with qualified contractors</p>
            <a href="/request-1099-cleaners" class="btn btn-light btn-lg">
                <i class="fas fa-plus-circle me-2"></i>Post a Job
            </a>
        </div>
    </div>
</div>
{% endblock %}
