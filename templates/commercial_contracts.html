{% extends "base.html" %}

{% block title %}Commercial Cleaning Contracts - Virginia{% endblock %}

{% block og_title %}Commercial Cleaning Opportunities in Virginia{% endblock %}
{% block og_description %}Discover private sector cleaning contracts for dental offices, law firms, real estate companies, gyms, hotels, and more in Virginia.{% endblock %}

{% block content %}

{% if show_upgrade_message %}
<!-- Subscriber-Only Access Message -->
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card border-0 shadow-lg">
                <div class="card-body text-center p-5">
                    <div class="mb-4" style="font-size: 5rem; opacity: 0.2;">ðŸ”’</div>
                    <h1 class="display-4 fw-bold mb-4">Exclusive Subscriber Content</h1>
                    <p class="lead mb-4">Commercial cleaning leads are only available to our premium subscribers.</p>
                    
                    <div class="row g-4 my-5">
                        <div class="col-md-6">
                            <div class="card h-100 border-primary">
                                <div class="card-body">
                                    <h3 class="text-primary mb-3">ðŸ’¼ What You Get</h3>
                                    <ul class="text-start">
                                        <li class="mb-2"><strong>Real Commercial Leads</strong> - Businesses actively looking for cleaners</li>
                                        <li class="mb-2"><strong>Full Contact Details</strong> - Direct phone, email, and business name</li>
                                        <li class="mb-2"><strong>Instant Email Alerts</strong> - Be the first to know about new leads</li>
                                        <li class="mb-2"><strong>Residential Leads Too</strong> - Access homeowner requests as well</li>
                                        <li class="mb-2"><strong>Bidding System</strong> - Submit proposals directly through platform</li>
                                        <li class="mb-2"><strong>Monthly Value Info</strong> - Know the contract worth upfront</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card h-100 border-success">
                                <div class="card-body">
                                    <h3 class="text-success mb-3">ðŸ“ˆ Hidden Perks</h3>
                                    <ul class="text-start">
                                        <li class="mb-2"><strong>Priority Access</strong> - Get leads first</li>
                                        <li class="mb-2"><strong>No Ads</strong> - Ad-free browsing experience</li>
                                        <li class="mb-2"><strong>Analytics Dashboard</strong> - Track your bids and wins</li>
                                        <li class="mb-2"><strong>Exclusive Training</strong> - Contract bidding resources</li>
                                        <li class="mb-2"><strong>Support Team</strong> - Priority customer support</li>
                                        <li class="mb-2"><strong>Cost Savings</strong> - Save $100s vs buying leads individually!</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info mb-4">
                        <i class="fas fa-calculator me-2"></i>
                        <strong>ROI Example:</strong> Just ONE commercial cleaning contract ($2,000-5,000/month) pays for your subscription for the entire year! Most subscribers land 3-5 contracts in their first month.
                    </div>

                    <a href="{{ url_for('register') }}" class="btn btn-primary btn-lg px-5 py-3 rounded-pill mb-3">
                        <i class="fas fa-rocket me-2"></i>Start Your Subscription
                    </a>
                    <br>
                    <small class="text-muted">Already a subscriber? <a href="{{ url_for('signin') }}">Sign In</a></small>
                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<!-- Commercial Contracts Hero -->
<div class="hero-section text-center">
    <div class="container">
        <h1 class="display-4 fw-bold">Commercial Cleaning Opportunities</h1>
        <p class="lead fs-4">Connect with private sector businesses looking for cleaning services</p>
        <div class="row justify-content-center mt-4">
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-4">
                        <div class="badge bg-light text-dark p-3 fs-6 w-100">
                            <i class="fas fa-building"></i><br>
                            <strong>20+</strong> Businesses
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="badge bg-warning text-dark p-3 fs-6 w-100">
                            <i class="fas fa-coins"></i><br>
                            <strong>5 Credits</strong> per lead
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="badge bg-success text-white p-3 fs-6 w-100">
                            <i class="fas fa-dollar-sign"></i><br>
                            <strong>$2.50</strong> per lead
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Filter Section -->
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Filter Commercial Opportunities</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <label class="form-label">Business Type:</label>
                            <select class="form-select" id="businessTypeFilter">
                                <option value="">All Types</option>
                                <option value="medical">Medical/Dental</option>
                                <option value="legal">Legal Services</option>
                                <option value="real-estate">Real Estate</option>
                                <option value="fitness">Fitness Centers</option>
                                <option value="hospitality">Hotels/Lodging</option>
                                <option value="education">Education Centers</option>
                                <option value="office">Office Spaces</option>
                                <option value="healthcare">Healthcare/Nursing</option>
                                <option value="childcare">Childcare</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Location:</label>
                            <select class="form-select" id="locationFilter">
                                <option value="">All Locations</option>
                                <option value="Hampton">Hampton</option>
                                <option value="Suffolk">Suffolk</option>
                                <option value="Virginia Beach">Virginia Beach</option>
                                <option value="Newport News">Newport News</option>
                                <option value="Williamsburg">Williamsburg</option>
                                <option value="Norfolk">Norfolk</option>
                                <option value="Chesapeake">Chesapeake</option>
                                <option value="Portsmouth">Portsmouth</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Size:</label>
                            <select class="form-select" id="sizeFilter">
                                <option value="">All Sizes</option>
                                <option value="small">Small (Under 5,000 sq ft)</option>
                                <option value="medium">Medium (5,000-15,000 sq ft)</option>
                                <option value="large">Large (15,000+ sq ft)</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Frequency:</label>
                            <select class="form-select" id="frequencyFilter">
                                <option value="">All Frequencies</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="one-time">One-time</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <button class="btn btn-primary" onclick="applyFilters()">Apply Filters</button>
                            <button class="btn btn-outline-secondary" onclick="clearFilters()">Clear All</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Commercial Opportunities Section -->
<div class="container my-5">
    <div class="row" id="commercial-opportunities">
        {% for opportunity in opportunities %}
        <div class="col-md-6 col-lg-4 mb-4 opportunity-card" 
             data-type="{{ opportunity.business_type }}" 
             data-location="{{ opportunity.location }}" 
             data-size="{{ opportunity.size }}"
             data-frequency="{{ opportunity.frequency }}">
            <div class="card h-100 contract-card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 text-primary">{{ opportunity.business_type | title }}</h6>
                    <span class="badge bg-success">{{ opportunity.frequency | title }}</span>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h5 class="card-title">{{ opportunity.business_name }}</h5>
                        <span class="city-badge">{{ opportunity.location }}</span>
                    </div>
                    <h6 class="card-subtitle mb-2 text-muted">{{ opportunity.address }}</h6>
                    <p class="card-text">{{ opportunity.description }}</p>
                    
                    <div class="row">
                        <div class="col-6">
                            <small class="text-muted">Est. Monthly Value:</small><br>
                            <strong class="text-success">${{ opportunity.monthly_value }}</strong>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Square Footage:</small><br>
                            <strong>{{ opportunity.square_footage | comma }} sq ft</strong>
                        </div>
                    </div>
                    
                    <div class="row mt-2">
                        <div class="col-6">
                            <small class="text-muted">Services Needed:</small><br>
                            <small>{{ opportunity.services_needed }}</small>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Contact:</small><br>
                            <small>{{ opportunity.contact_type }}</small>
                        </div>
                    </div>
                    
                    <div class="mt-2">
                        <small class="text-muted">Special Requirements:</small><br>
                        <small class="text-info">{{ opportunity.special_requirements }}</small>
                    </div>
                </div>
                <div class="card-footer bg-transparent d-flex justify-content-between align-items-center">
                    <div>
                        <button class="btn btn-primary btn-sm" onclick="requestContact('{{ opportunity.id }}', '{{ opportunity.business_name }}')">
                            <i class="fas fa-coins"></i> Get Contact Info
                        </button>
                        <button class="btn btn-outline-secondary btn-sm" onclick="shareCommercialOpportunity('{{ opportunity.business_name | safe }}', '{{ opportunity.description[:150] | safe }}...', '{{ opportunity.location }}', '${{ opportunity.monthly_value }}', '{{ opportunity.business_type }}')">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                    </div>
                    <div class="text-end">
                        <small class="text-muted">Cost:</small><br>
                        <strong class="text-warning">5 Credits</strong><br>
                        <small class="text-success">($2.50)</small>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Business Types Overview -->
<div class="bg-light py-5">
    <div class="container">
        <h2 class="text-center mb-5">Commercial Cleaning Opportunities by Sector</h2>
        
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center">
                    <div class="card-body">
                        <i class="fas fa-user-md fa-3x text-primary mb-3"></i>
                        <h5>Medical & Dental</h5>
                        <p>Dental offices, doctor's offices, medical practices, urgent care centers</p>
                        <ul class="list-unstyled small">
                            <li>â€¢ High-frequency cleaning</li>
                            <li>â€¢ Specialized sanitization</li>
                            <li>â€¢ HIPAA compliance required</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center">
                    <div class="card-body">
                        <i class="fas fa-dumbbell fa-3x text-success mb-3"></i>
                        <h5>Fitness & Wellness</h5>
                        <p>Gyms, fitness centers, yoga studios, wellness centers</p>
                        <ul class="list-unstyled small">
                            <li>â€¢ Locker room cleaning</li>
                            <li>â€¢ Equipment sanitization</li>
                            <li>â€¢ High-traffic areas</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center">
                    <div class="card-body">
                        <i class="fas fa-balance-scale fa-3x text-warning mb-3"></i>
                        <h5>Legal & Professional</h5>
                        <p>Law offices, accounting firms, consulting companies</p>
                        <ul class="list-unstyled small">
                            <li>â€¢ Professional appearance</li>
                            <li>â€¢ Confidentiality important</li>
                            <li>â€¢ Flexible scheduling</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center">
                    <div class="card-body">
                        <i class="fas fa-home fa-3x text-info mb-3"></i>
                        <h5>Real Estate & Property</h5>
                        <p>Real estate offices, property management companies, leasing offices</p>
                        <ul class="list-unstyled small">
                            <li>â€¢ Move-out cleaning</li>
                            <li>â€¢ Show-ready maintenance</li>
                            <li>â€¢ Variable scheduling</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center">
                    <div class="card-body">
                        <i class="fas fa-hotel fa-3x text-secondary mb-3"></i>
                        <h5>Hospitality</h5>
                        <p>Hotels, motels, bed & breakfasts, extended stay facilities</p>
                        <ul class="list-unstyled small">
                            <li>â€¢ Daily housekeeping</li>
                            <li>â€¢ Deep cleaning services</li>
                            <li>â€¢ 24/7 availability</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center">
                    <div class="card-body">
                        <i class="fas fa-graduation-cap fa-3x text-danger mb-3"></i>
                        <h5>Education & Childcare</h5>
                        <p>Private schools, daycare centers, tutoring centers, training facilities</p>
                        <ul class="list-unstyled small">
                            <li>â€¢ Child-safe products</li>
                            <li>â€¢ After-hours cleaning</li>
                            <li>â€¢ Background checks required</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CTA Section -->
<div class="cta-section text-center">
    <div class="container">
        <h3>Ready to Connect with Commercial Clients?</h3>
        <p class="lead">Register to receive notifications about new commercial cleaning opportunities.</p>
        <a href="{{ url_for('register') }}" class="btn btn-light btn-lg">Get Commercial Leads</a>
    </div>
</div>

<script>
function applyFilters() {
    const businessType = document.getElementById('businessTypeFilter').value;
    const location = document.getElementById('locationFilter').value;
    const size = document.getElementById('sizeFilter').value;
    const frequency = document.getElementById('frequencyFilter').value;
    
    const cards = document.querySelectorAll('.opportunity-card');
    
    cards.forEach(card => {
        let show = true;
        
        if (businessType && card.dataset.type !== businessType) show = false;
        if (location && card.dataset.location !== location) show = false;
        if (size && card.dataset.size !== size) show = false;
        if (frequency && card.dataset.frequency !== frequency) show = false;
        
        card.style.display = show ? 'block' : 'none';
    });
}

function clearFilters() {
    document.getElementById('businessTypeFilter').value = '';
    document.getElementById('locationFilter').value = '';
    document.getElementById('sizeFilter').value = '';
    document.getElementById('frequencyFilter').value = '';
    
    const cards = document.querySelectorAll('.opportunity-card');
    cards.forEach(card => {
        card.style.display = 'block';
    });
}

function requestContact(opportunityId, businessName) {
    // Check credits before proceeding
    if (!checkCreditsBeforeRequest()) {
        return; // Credits check failed, alert shown by base template function
    }

    if (confirm(`Request contact information for ${businessName}?\n\nðŸ’° Cost: 5 Credits ($2.50)\nðŸ’³ Current balance: ${currentCredits} credits\n\nAfter this purchase you'll have ${currentCredits - 5} credits remaining.`)) {
        // Disable the button to prevent double-clicks
        const buttons = document.querySelectorAll(`button[onclick*="${opportunityId}"]`);
        buttons.forEach(btn => {
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        });

        fetch('/request-commercial-contact', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                opportunity_id: opportunityId,
                business_name: businessName,
                user_email: 'demo@example.com' // In real app, get from session
            })
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                // Update credits in navigation
                updateCreditsAfterRequest(result.credits_used || 5);
                
                // Show success message with contact info
                showContactInfoModal(result.contact_info, businessName, result.new_credits_balance);
                
                // Show low credits alert if needed
                if (result.new_credits_balance <= 10 && result.new_credits_balance > 0) {
                    setTimeout(() => showCreditsAlert('low'), 2000);
                } else if (result.new_credits_balance === 0) {
                    setTimeout(() => showCreditsAlert('out'), 2000);
                }
            } else {
                showToastCommercial(result.message || 'Error requesting contact information.', 'error');
                
                // If it's a credits issue, show credits alert
                if (result.message && result.message.toLowerCase().includes('credit')) {
                    setTimeout(() => showCreditsAlert(result.credits_balance === 0 ? 'out' : 'low'), 1000);
                }
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showToastCommercial('Error requesting contact information. Please try again.', 'error');
        })
        .finally(() => {
            // Re-enable buttons
            buttons.forEach(btn => {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-coins"></i> Get Contact Info';
            });
        });
    }
}

function showContactInfoModal(contactInfo, businessName, newCreditsBalance) {
    const modal = document.createElement('div');
    modal.className = 'modal fade';
    modal.id = 'contactInfoModal';
    modal.innerHTML = `
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-check-circle"></i> Contact Information Retrieved
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>Success!</strong> Contact information for <strong>${businessName}</strong> has been sent to your email.
                        <br><small class="text-muted">Credits remaining: ${newCreditsBalance}</small>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-user"></i> Contact Person</h6>
                            <p class="mb-3">${contactInfo.contact_person || 'N/A'}</p>
                            
                            <h6><i class="fas fa-envelope"></i> Email</h6>
                            <p class="mb-3">
                                <a href="mailto:${contactInfo.email}">${contactInfo.email}</a>
                                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="copyToClipboard('${contactInfo.email}')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </p>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-phone"></i> Phone</h6>
                            <p class="mb-3">
                                <a href="tel:${contactInfo.phone}">${contactInfo.phone}</a>
                                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="copyToClipboard('${contactInfo.phone}')">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </p>
                            
                            <h6><i class="fas fa-building"></i> Business</h6>
                            <p class="mb-3">${businessName}</p>
                        </div>
                    </div>
                    
                    ${contactInfo.website ? `
                        <div class="mt-3">
                            <h6><i class="fas fa-globe"></i> Website</h6>
                            <p><a href="${contactInfo.website}" target="_blank">${contactInfo.website}</a></p>
                        </div>
                    ` : ''}
                    
                    ${contactInfo.best_time_to_contact ? `
                        <div class="mt-3">
                            <h6><i class="fas fa-clock"></i> Best Time to Contact</h6>
                            <p>${contactInfo.best_time_to_contact}</p>
                        </div>
                    ` : ''}
                    
                    ${contactInfo.special_notes ? `
                        <div class="mt-3">
                            <h6><i class="fas fa-info-circle"></i> Special Notes</h6>
                            <p class="text-muted">${contactInfo.special_notes}</p>
                        </div>
                    ` : ''}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="window.location.href='/credits'">
                        <i class="fas fa-coins"></i> Buy More Credits
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    const bsModal = new bootstrap.Modal(modal);
    bsModal.show();
    
    // Clean up modal after hiding
    modal.addEventListener('hidden.bs.modal', () => {
        document.body.removeChild(modal);
    });
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        showToastCommercial('Copied to clipboard!', 'success');
    }).catch(err => {
        console.error('Failed to copy: ', err);
        showToastCommercial('Failed to copy', 'error');
    });
}

function shareCommercialOpportunity(businessName, description, location, value, type) {
    const shareData = {
        title: `${businessName} - Commercial Cleaning Opportunity`,
        text: `${description}\n\nLocation: ${location}\nValue: ${value}/month\nType: ${type}\n\nVia VA Contract Hub`,
        url: window.location.href
    };
    
    // Try native sharing first (mobile devices)
    if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
        navigator.share(shareData)
            .then(() => console.log('Opportunity shared successfully'))
            .catch((error) => {
                console.log('Error sharing:', error);
                fallbackShareCommercial(shareData);
            });
    } else {
        // Fallback to custom share modal
        fallbackShareCommercial(shareData);
    }
}

function fallbackShareCommercial(shareData) {
    // Create share modal (similar to contracts.html)
    const modal = document.createElement('div');
    modal.className = 'modal fade';
    modal.innerHTML = `
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Share Commercial Opportunity</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Share Link:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="shareCommercialUrl" value="${shareData.url}" readonly>
                            <button class="btn btn-outline-secondary" onclick="copyToClipboardCommercial('shareCommercialUrl')">Copy</button>
                        </div>
                    </div>
                    <div class="row text-center">
                        <div class="col-4">
                            <a href="mailto:?subject=${encodeURIComponent(shareData.title)}&body=${encodeURIComponent(shareData.text + '\\n\\n' + shareData.url)}" 
                               class="btn btn-outline-primary w-100 mb-2">
                                <i class="fas fa-envelope"></i><br>Email
                            </a>
                        </div>
                        <div class="col-4">
                            <a href="https://twitter.com/intent/tweet?text=${encodeURIComponent(shareData.text)}&url=${encodeURIComponent(shareData.url)}" 
                               target="_blank" class="btn btn-outline-info w-100 mb-2">
                                <i class="fab fa-twitter"></i><br>Twitter
                            </a>
                        </div>
                        <div class="col-4">
                            <a href="https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareData.url)}" 
                               target="_blank" class="btn btn-outline-primary w-100 mb-2">
                                <i class="fab fa-linkedin"></i><br>LinkedIn
                            </a>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    const bsModal = new bootstrap.Modal(modal);
    bsModal.show();
    
    // Clean up modal after hiding
    modal.addEventListener('hidden.bs.modal', () => {
        document.body.removeChild(modal);
    });
}

function copyToClipboardCommercial(elementId) {
    const element = document.getElementById(elementId);
    element.select();
    element.setSelectionRange(0, 99999);
    
    try {
        document.execCommand('copy');
        showToastCommercial('Link copied to clipboard!', 'success');
    } catch (err) {
        console.error('Failed to copy: ', err);
        showToastCommercial('Failed to copy link', 'error');
    }
}

function showToastCommercial(message, type) {
    // Create toast notification
    const toast = document.createElement('div');
    toast.className = `toast align-items-center text-white bg-${type === 'success' ? 'success' : 'danger'} border-0`;
    toast.setAttribute('role', 'alert');
    toast.innerHTML = `
        <div class="d-flex">
            <div class="toast-body">${message}</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    `;
    
    // Add to page
    let toastContainer = document.querySelector('.toast-container');
    if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.className = 'toast-container position-fixed bottom-0 end-0 p-3';
        document.body.appendChild(toastContainer);
    }
    
    toastContainer.appendChild(toast);
    const bsToast = new bootstrap.Toast(toast);
    bsToast.show();
    
    // Clean up after hiding
    toast.addEventListener('hidden.bs.toast', () => {
        toastContainer.removeChild(toast);
    });
}
</script>

<style>
.cta-section {
    background: linear-gradient(135deg, #198754, #20c997);
    color: white;
    padding: 3rem 0;
}
</style>

{% endif %}
{% endblock %}