{% extends "base.html" %}

{% block title %}Mini Toolbox - Free Resources{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section text-center py-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="container">
        <h1 class="display-4 fw-bold text-white">
            <i class="fas fa-toolbox me-3"></i>Mini Toolbox
        </h1>
        <p class="lead fs-4 text-white">Free essential tools to help you get started</p>
        <p class="text-white">
            <i class="fas fa-lock-open me-2"></i>No registration required
        </p>
    </div>
</div>

<div class="container my-5">
    
    <!-- Upgrade Banner -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="alert alert-info border-0 shadow-sm" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
                <div class="d-flex align-items-center">
                    <i class="fas fa-star fa-2x text-primary me-3"></i>
                    <div class="flex-grow-1">
                        <h5 class="mb-1">Unlock the Full Toolbox!</h5>
                        <p class="mb-2">Get access to advanced tools, calculators, templates, and AI-powered features.</p>
                    </div>
                    <a href="{{ url_for('auth') }}" class="btn btn-primary">
                        <i class="fas fa-unlock me-2"></i>Sign Up Free
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Free Tools Grid -->
    <div class="row g-4">
        
        <!-- Basic Pricing Calculator -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-calculator fa-3x text-primary"></i>
                    </div>
                    <h4 class="card-title">Basic Pricing Calculator</h4>
                    <p class="card-text text-muted">Simple square footage calculator for cleaning estimates</p>
                    <button class="btn btn-outline-primary" onclick="showBasicCalculator()">
                        <i class="fas fa-play me-2"></i>Use Tool
                    </button>
                </div>
            </div>
        </div>

        <!-- Checklist Generator -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-tasks fa-3x text-success"></i>
                    </div>
                    <h4 class="card-title">Cleaning Checklist</h4>
                    <p class="card-text text-muted">Downloadable checklists for different cleaning types</p>
                    <button class="btn btn-outline-success" onclick="showChecklists()">
                        <i class="fas fa-download me-2"></i>Download
                    </button>
                </div>
            </div>
        </div>

        <!-- Post-Construction Cleanup -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-hammer fa-3x text-warning"></i>
                    </div>
                    <h4 class="card-title">Post-Construction Cleanup</h4>
                    <p class="card-text text-muted">Checklist with pricing, staffing & timeline</p>
                    <button class="btn btn-outline-warning" onclick="showPostConstructionChecklist()">
                        <i class="fas fa-list me-2"></i>View Details
                    </button>
                </div>
            </div>
        </div>

        <!-- Commercial Cleaning Pro -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-building fa-3x text-info"></i>
                    </div>
                    <h4 class="card-title">Commercial Cleaning</h4>
                    <p class="card-text text-muted">Complete guide with pricing & staffing</p>
                    <button class="btn btn-outline-info" onclick="showCommercialCleaningChecklist()">
                        <i class="fas fa-list me-2"></i>View Details
                    </button>
                </div>
            </div>
        </div>

        <!-- Residential Cleaning Pro -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-home fa-3x text-primary"></i>
                    </div>
                    <h4 class="card-title">Residential Cleaning</h4>
                    <p class="card-text text-muted">Residential guide with pricing & staffing</p>
                    <button class="btn btn-outline-primary" onclick="showResidentialCleaningChecklist()">
                        <i class="fas fa-list me-2"></i>View Details
                    </button>
                </div>
            </div>
        </div>

        <!-- Industry Resources -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-book-open fa-3x text-info"></i>
                    </div>
                    <h4 class="card-title">Industry Links</h4>
                    <p class="card-text text-muted">Quick links to government contracting resources</p>
                    <button class="btn btn-outline-info" onclick="showResources()">
                        <i class="fas fa-external-link-alt me-2"></i>View Links
                    </button>
                </div>
            </div>
        </div>

        <!-- Bid Timeline Template -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-calendar-alt fa-3x text-warning"></i>
                    </div>
                    <h4 class="card-title">Bid Timeline</h4>
                    <p class="card-text text-muted">Basic timeline template for contract submissions</p>
                    <button class="btn btn-outline-warning" onclick="showTimeline()">
                        <i class="fas fa-eye me-2"></i>View Template
                    </button>
                </div>
            </div>
        </div>

        <!-- Contract Glossary -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-book fa-3x text-danger"></i>
                    </div>
                    <h4 class="card-title">Contract Glossary</h4>
                    <p class="card-text text-muted">Common government contracting terms explained</p>
                    <button class="btn btn-outline-danger" onclick="showGlossary()">
                        <i class="fas fa-search me-2"></i>Browse Terms
                    </button>
                </div>
            </div>
        </div>

        <!-- Procurement Lifecycle Map -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-route fa-3x text-primary"></i>
                    </div>
                    <h4 class="card-title">Procurement Lifecycle</h4>
                    <p class="card-text text-muted">Complete guide to the procurement process with FAR references</p>
                    <a href="{{ url_for('procurement_lifecycle') }}" class="btn btn-outline-primary">
                        <i class="fas fa-map me-2"></i>View Guide
                    </a>
                </div>
            </div>
        </div>

        <!-- Getting Started Guide -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-graduation-cap fa-3x text-purple"></i>
                    </div>
                    <h4 class="card-title">Getting Started Guide</h4>
                    <p class="card-text text-muted">Step-by-step guide to government contracting</p>
                    <button class="btn btn-outline-secondary" onclick="showGuide()">
                        <i class="fas fa-play-circle me-2"></i>Start Guide
                    </button>
                </div>
            </div>
        </div>

        <!-- Invoice Creator -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm hover-lift">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-file-invoice fa-3x text-success"></i>
                    </div>
                    <h4 class="card-title">Invoice Creator</h4>
                    <p class="card-text text-muted">Create, email, and save invoices to your profile</p>
                    <button class="btn btn-outline-success" onclick="showInvoiceCreator()">
                        <i class="fas fa-plus me-2"></i>Create Invoice
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- Call to Action for Full Toolbox -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card border-primary shadow-lg">
                <div class="card-body text-center py-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h3 class="text-white fw-bold mb-3">
                        <i class="fas fa-crown me-2"></i>Unlock the Full Resource Toolbox
                    </h3>
                    <p class="text-white fs-5 mb-4">Get access to AI-powered tools, advanced calculators, and premium templates</p>
                    <div class="d-flex justify-content-center gap-3">
                        <a href="{{ url_for('auth') }}" class="btn btn-light btn-lg px-5 py-3 rounded-pill">
                            <i class="fas fa-user-plus me-2"></i>Sign Up Free
                        </a>
                        <a href="{{ url_for('resource_toolbox') }}" class="btn btn-outline-light btn-lg px-5 py-3 rounded-pill">
                            <i class="fas fa-eye me-2"></i>View Full Toolbox
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Removed Premium Features Locked Section -->
                    <p class="card-text text-muted small">100+ professional templates</p>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm" style="opacity: 0.7; position: relative;">
                <div class="card-body text-center">
                    <i class="fas fa-lock position-absolute top-0 end-0 m-3 text-muted"></i>
                    <div class="mb-3">
                        <i class="fas fa-headset fa-3x text-muted"></i>
                    </div>
                    <h5 class="card-title">Expert Support</h5>
                    <p class="card-text text-muted small">1-on-1 consultation</p>
                </div>
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <div class="row mt-5">
        <div class="col-12 text-center">
            <div class="p-5 rounded" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <h2 class="text-white mb-3">Ready for the Full Experience?</h2>
                <p class="text-white fs-5 mb-4">Join thousands of contractors winning government contracts</p>
                <a href="{{ url_for('auth') }}" class="btn btn-light btn-lg me-3">
                    <i class="fas fa-user-plus me-2"></i>Create Free Account
                </a>
                <a href="{{ url_for('subscription') }}" class="btn btn-outline-light btn-lg">
                    <i class="fas fa-eye me-2"></i>View Pricing
                </a>
            </div>
        </div>
    </div>

</div>

<!-- Tool Modals -->
<div class="modal fade" id="toolModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="toolModalTitle">Tool</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="toolModalBody">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>
</div>

<style>
.hover-lift {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.hover-lift:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
}
.text-purple {
    color: #764ba2;
}
</style>

<script>
function showBasicCalculator() {
    document.getElementById('toolModalTitle').textContent = 'Basic Pricing Calculator';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <h6>Calculate cleaning costs based on square footage</h6>
            <form id="calculatorForm">
                <div class="mb-3">
                    <label class="form-label">Square Footage</label>
                    <input type="number" class="form-control" id="sqft" placeholder="Enter square footage" step="100">
                </div>
                <div class="mb-3">
                    <label class="form-label">Rate per Square Foot ($)</label>
                    <input type="number" class="form-control" id="rate" value="0.15" step="0.01" min="0">
                </div>
                <div class="mb-3">
                    <label class="form-label">Additional Services ($)</label>
                    <input type="number" class="form-control" id="additional" value="0" step="0.01" min="0">
                </div>
                <button type="button" class="btn btn-primary" onclick="calculatePrice()">
                    <i class="fas fa-calculator me-2"></i>Calculate
                </button>
            </form>
            <hr>
            <div id="totalDisplay" class="mb-3" style="display:none;">
                <div class="card bg-light">
                    <div class="card-body">
                        <p class="text-muted mb-2">Base Cleaning Cost:</p>
                        <p class="mb-2"><strong id="baseCost">$0.00</strong></p>
                        <p class="text-muted mb-2">Additional Services:</p>
                        <p class="mb-2"><strong id="additionalCost">$0.00</strong></p>
                        <hr>
                        <p class="text-muted mb-2">Total Estimated Cost:</p>
                        <h4 class="text-success mb-0" id="totalCost">$0.00</h4>
                    </div>
                </div>
            </div>
            <div id="result" class="mt-3"></div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function calculatePrice() {
    const sqft = parseFloat(document.getElementById('sqft').value) || 0;
    const rate = parseFloat(document.getElementById('rate').value) || 0;
    const additional = parseFloat(document.getElementById('additional').value) || 0;
    
    if (sqft > 0 && rate > 0) {
        const baseCost = sqft * rate;
        const totalCost = baseCost + additional;
        
        document.getElementById('baseCost').textContent = `$${baseCost.toFixed(2)}`;
        document.getElementById('additionalCost').textContent = `$${additional.toFixed(2)}`;
        document.getElementById('totalCost').textContent = `$${totalCost.toFixed(2)}`;
        document.getElementById('totalDisplay').style.display = 'block';
        
        document.getElementById('result').innerHTML = `
            <div class="alert alert-success">
                <h5><i class="fas fa-check-circle me-2"></i>Calculation Complete!</h5>
                <p class="mb-0">For ${sqft} sq ft @ $${rate}/sq ft + $${additional.toFixed(2)} services = <strong>$${totalCost.toFixed(2)}</strong></p>
            </div>
        `;
    } else {
        document.getElementById('result').innerHTML = `
            <div class="alert alert-danger">
                <i class="fas fa-exclamation-triangle me-2"></i>Please enter valid values for square footage and rate.
            </div>
        `;
    }
}

function showChecklists() {
    document.getElementById('toolModalTitle').textContent = 'Cleaning Checklists';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <style>
                .checklist-tabs .nav-link {
                    background-color: #f8f9fa;
                    color: #333;
                    border: 1px solid #dee2e6;
                    font-weight: 500;
                    transition: all 0.3s ease;
                }
                .checklist-tabs .nav-link.active {
                    background-color: #667eea;
                    color: white;
                    border-color: #667eea;
                }
                .checklist-tabs .nav-link:hover:not(.active) {
                    background-color: #e9ecef;
                    color: #333;
                }
                .phase-section {
                    margin: 15px 0;
                    padding: 12px;
                    background-color: #f8f9fa;
                    border-left: 4px solid #667eea;
                    border-radius: 4px;
                }
                .phase-title {
                    font-weight: 600;
                    color: #667eea;
                    margin-bottom: 10px;
                    font-size: 0.95rem;
                }
                .form-check {
                    margin-bottom: 8px;
                }
            </style>
            <ul class="nav nav-tabs mb-3 checklist-tabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="office-tab" data-bs-toggle="tab" data-bs-target="#officeChecklist" type="button">Office</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="restroom-tab" data-bs-toggle="tab" data-bs-target="#restroomChecklist" type="button">Restroom</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="school-tab" data-bs-toggle="tab" data-bs-target="#schoolChecklist" type="button">School</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="warehouse-tab" data-bs-toggle="tab" data-bs-target="#warehouseChecklist" type="button">Warehouse</button>
                </li>
            </ul>
            
            <div class="tab-content">
                <div class="tab-pane fade show active" id="officeChecklist">
                    <h6 class="mb-3">âœ“ Office Cleaning Checklist</h6>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸ”µ PHASE 1: PRE-CLEAN (Setup & Safety)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office1">
                            <label class="form-check-label" for="office1">Post wet floor signs if mopping</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office2">
                            <label class="form-check-label" for="office2">Set up cleaning stations and equipment</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office3">
                            <label class="form-check-label" for="office3">Collect and empty all trash bins and recycling</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office4">
                            <label class="form-check-label" for="office4">Straighten chairs and organize desks</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office5">
                            <label class="form-check-label" for="office5">Remove personal items from floor</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¢ PHASE 2: DEEP CLEAN (Main Tasks)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office6">
                            <label class="form-check-label" for="office6">Dust all desk surfaces and furniture</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office7">
                            <label class="form-check-label" for="office7">Vacuum carpets and rugs thoroughly</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office8">
                            <label class="form-check-label" for="office8">Mop hard floors with appropriate cleaner</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office9">
                            <label class="form-check-label" for="office9">Clean windows and glass partitions</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office10">
                            <label class="form-check-label" for="office10">Wipe down kitchen/break room surfaces</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office11">
                            <label class="form-check-label" for="office11">Clean and disinfect refrigerator handles</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office12">
                            <label class="form-check-label" for="office12">Sanitize high-touch areas (doorknobs, switches)</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¡ PHASE 3: FINAL INSPECTION & FINISHING</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office13">
                            <label class="form-check-label" for="office13">Restock paper towels and restroom supplies</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office14">
                            <label class="form-check-label" for="office14">Empty restroom waste bins</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office15">
                            <label class="form-check-label" for="office15">Final walkthrough for missed spots</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="office16">
                            <label class="form-check-label" for="office16">Ensure all lights are on and building is secure</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="office17">
                            <label class="form-check-label" for="office17">Document any damage or special requests</label>
                        </div>
                    </div>
                    
                    <button class="btn btn-sm btn-outline-primary" onclick="downloadChecklist('Office')">
                        <i class="fas fa-download me-2"></i>Download as PDF
                    </button>
                </div>
                
                <div class="tab-pane fade" id="restroomChecklist">
                    <h6 class="mb-3">âœ“ Restroom Cleaning Checklist</h6>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸ”µ PHASE 1: PRE-CLEAN (Setup & Safety)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest1">
                            <label class="form-check-label" for="rest1">Post wet floor and occupied signs</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest2">
                            <label class="form-check-label" for="rest2">Gather all cleaning supplies and equipment</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest3">
                            <label class="form-check-label" for="rest3">Empty all waste bins and replace liners</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest4">
                            <label class="form-check-label" for="rest4">Inspect for damage or maintenance issues</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest5">
                            <label class="form-check-label" for="rest5">Remove personal items from counters</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¢ PHASE 2: DEEP CLEAN (Main Tasks)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest6">
                            <label class="form-check-label" for="rest6">Clean and disinfect all toilets (interior & exterior)</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest7">
                            <label class="form-check-label" for="rest7">Clean and disinfect urinals (if applicable)</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest8">
                            <label class="form-check-label" for="rest8">Scrub and sanitize all sinks and faucets</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest9">
                            <label class="form-check-label" for="rest9">Clean mirrors and glass partitions</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest10">
                            <label class="form-check-label" for="rest10">Mop and sanitize floors with appropriate cleaner</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest11">
                            <label class="form-check-label" for="rest11">Clean walls and baseboards for splashing</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest12">
                            <label class="form-check-label" for="rest12">Sanitize all dispensers (soap, sanitizer, etc.)</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¡ PHASE 3: FINAL INSPECTION & FINISHING</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest13">
                            <label class="form-check-label" for="rest13">Refill toilet paper in all stalls</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest14">
                            <label class="form-check-label" for="rest14">Refill paper towel dispensers</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest15">
                            <label class="form-check-label" for="rest15">Refill soap and hand sanitizer dispensers</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest16">
                            <label class="form-check-label" for="rest16">Final walkthrough for cleanliness</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="rest17">
                            <label class="form-check-label" for="rest17">Remove wet floor signs when area is dry</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="rest18">
                            <label class="form-check-label" for="rest18">Document any maintenance needs or damage</label>
                        </div>
                    </div>
                    
                    <button class="btn btn-sm btn-outline-primary" onclick="downloadChecklist('Restroom')">
                        <i class="fas fa-download me-2"></i>Download as PDF
                    </button>
                </div>
                
                                
                <div class="tab-pane fade" id="schoolChecklist">
                    <h6 class="mb-3">âœ“ School Cleaning Checklist</h6>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸ”µ PHASE 1: PRE-CLEAN (Setup & Safety)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school1">
                            <label class="form-check-label" for="school1">Post wet floor and restricted area signs</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school2">
                            <label class="form-check-label" for="school2">Gather all cleaning supplies and equipment</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school3">
                            <label class="form-check-label" for="school3">Empty all waste and recycling bins</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school4">
                            <label class="form-check-label" for="school4">Clear desks and floors of student items</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school5">
                            <label class="form-check-label" for="school5">Inspect for spills, damage, or safety hazards</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¢ PHASE 2: DEEP CLEAN (Main Tasks)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school6">
                            <label class="form-check-label" for="school6">Dust all surfaces including desks and shelves</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school7">
                            <label class="form-check-label" for="school7">Wipe whiteboards and glass boards clean</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school8">
                            <label class="form-check-label" for="school8">Vacuum all carpeted areas thoroughly</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school9">
                            <label class="form-check-label" for="school9">Mop and sanitize tile and hard floors</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school10">
                            <label class="form-check-label" for="school10">Sanitize cafeteria tables and chairs</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school11">
                            <label class="form-check-label" for="school11">Clean and sanitize all restroom facilities</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school12">
                            <label class="form-check-label" for="school12">Wipe all high-touch surfaces and door handles</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school13">
                            <label class="form-check-label" for="school13">Clean athletic areas and bleachers if applicable</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school14">
                            <label class="form-check-label" for="school14">Sanitize gym equipment and mats</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¡ PHASE 3: FINAL INSPECTION & FINISHING</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school15">
                            <label class="form-check-label" for="school15">Restock bathroom supplies (toilet paper, soap)</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school16">
                            <label class="form-check-label" for="school16">Empty cafeteria waste and sanitize bins</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school17">
                            <label class="form-check-label" for="school17">Final walkthrough of all classrooms</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="school18">
                            <label class="form-check-label" for="school18">Remove all wet floor signs and barriers</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="school19">
                            <label class="form-check-label" for="school19">Report any maintenance issues to administration</label>
                        </div>
                    </div>
                    
                    <button class="btn btn-sm btn-outline-primary" onclick="downloadChecklist('School')">
                        <i class="fas fa-download me-2"></i>Download as PDF
                    </button>
                </div>
                
                                
                <div class="tab-pane fade" id="warehouseChecklist">
                    <h6 class="mb-3">âœ“ Warehouse Cleaning Checklist</h6>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸ”µ PHASE 1: PRE-CLEAN (Setup & Safety)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse1">
                            <label class="form-check-label" for="warehouse1">Post hazard and wet floor signs</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse2">
                            <label class="form-check-label" for="warehouse2">Turn off equipment and machines if safe</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse3">
                            <label class="form-check-label" for="warehouse3">Sweep up debris and larger waste items</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse4">
                            <label class="form-check-label" for="warehouse4">Empty all waste bins and dumpsters</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse5">
                            <label class="form-check-label" for="warehouse5">Set up cleaning equipment and supplies</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¢ PHASE 2: DEEP CLEAN (Main Tasks)</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse6">
                            <label class="form-check-label" for="warehouse6">Deep clean and seal warehouse floors</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse7">
                            <label class="form-check-label" for="warehouse7">Clean loading dock and entrance area</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse8">
                            <label class="form-check-label" for="warehouse8">Dust and wipe warehouse shelving and racking</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse9">
                            <label class="form-check-label" for="warehouse9">Clean and sanitize break room</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse10">
                            <label class="form-check-label" for="warehouse10">Sanitize all restroom facilities</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse11">
                            <label class="form-check-label" for="warehouse11">Wipe high-touch surfaces and door handles</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse12">
                            <label class="form-check-label" for="warehouse12">Clean office areas and desks</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse13">
                            <label class="form-check-label" for="warehouse13">Remove grease and oil stains from floors</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse14">
                            <label class="form-check-label" for="warehouse14">Clean windows and skylights if accessible</label>
                        </div>
                    </div>
                    
                    <div class="phase-section">
                        <div class="phase-title">ðŸŸ¡ PHASE 3: FINAL INSPECTION & FINISHING</div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse15">
                            <label class="form-check-label" for="warehouse15">Restock bathroom and break room supplies</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse16">
                            <label class="form-check-label" for="warehouse16">Empty office and break room waste bins</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse17">
                            <label class="form-check-label" for="warehouse17">Final walkthrough of entire warehouse</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse18">
                            <label class="form-check-label" for="warehouse18">Remove all wet floor signs and barriers</label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" id="warehouse19">
                            <label class="form-check-label" for="warehouse19">Document any maintenance issues or hazards</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="warehouse20">
                            <label class="form-check-label" for="warehouse20">Notify supervisor of completion</label>
                        </div>
                    </div>
                    
                    <button class="btn btn-sm btn-outline-primary" onclick="downloadChecklist('Warehouse')">
                        <i class="fas fa-download me-2"></i>Download as PDF
                    </button>
                </div>
            </div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function downloadChecklist(type) {
    alert('âœ“ ' + type + ' Checklist downloaded! For full functionality, sign up for a premium account.');
}

function showPostConstructionChecklist() {
    document.getElementById('toolModalTitle').textContent = 'Post-Construction Cleanup & Windows';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3" style="max-height: 600px; overflow-y: auto;">
            <ul class="nav nav-tabs mb-3" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#postconstChecklist">Checklist</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#postconstPricing">Pricing & Staffing</a>
                </li>
            </ul>
            
            <div class="tab-content">
                <div class="tab-pane fade show active" id="postconstChecklist">
                    <h6 class="mb-3">Post-Construction Cleanup Tasks</h6>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Remove protective coverings & tarps</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Sweep and vacuum all debris</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Remove stickers, labels, and adhesive residue</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean all surfaces and fixtures</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Polish/clean windows (interior & exterior)</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Remove dust from HVAC vents</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean fixtures and hardware</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Final walkthrough and touch-ups</div>
                </div>
                
                <div class="tab-pane fade" id="postconstPricing">
                    <h6 class="mb-3">Pricing Calculator</h6>
                    <div class="mb-3">
                        <label class="form-label">Square Footage</label>
                        <input type="number" class="form-control" id="postconstSqft" placeholder="Enter sq ft" value="5000" min="100">
                    </div>
                    <div id="postconstResults"></div>
                    <button class="btn btn-primary mt-3" onclick="calculatePostConstructionPricing()">Calculate Pricing</button>
                </div>
            </div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function calculatePostConstructionPricing() {
    const sqft = parseFloat(document.getElementById('postconstSqft').value) || 5000;
    
    // Pricing: $0.50-0.75 per sq ft for post-construction
    const baseRate = 0.60;
    const basePrice = sqft * baseRate;
    
    // Staffing calculation
    let staff = 1;
    if (sqft > 3000) staff = 2;
    if (sqft > 7000) staff = 3;
    if (sqft > 12000) staff = 4;
    
    // Days needed (estimate: 1 person can do 3000-5000 sq ft per day)
    const daysPerPerson = sqft / 4000;
    const totalDays = Math.ceil(daysPerPerson);
    
    // Employee costs (assume $20/hr, 8hr day)
    const hourlyRate = 20;
    const dailyEmployeeCost = hourlyRate * 8 * staff;
    const totalEmployeeCost = dailyEmployeeCost * totalDays;
    
    // Materials (15% of labor)
    const materialsCost = totalEmployeeCost * 0.15;
    
    // Taxes (assume 15% of revenue)
    const taxableAmount = basePrice;
    const taxes = taxableAmount * 0.15;
    
    // Total
    const totalCost = basePrice + materials + taxes;
    const profitMargin = basePrice - totalEmployeeCost - materialsCost;
    
    const html = `
        <div class="alert alert-info">
            <strong>Job Estimate for ${sqft.toLocaleString()} sq ft:</strong>
        </div>
        <table class="table table-sm">
            <tr>
                <td><strong>Base Pricing:</strong></td>
                <td><strong>$${basePrice.toFixed(2)}</strong> (@$0.60/sqft)</td>
            </tr>
            <tr>
                <td>Staff Required:</td>
                <td>${staff} person(s)</td>
            </tr>
            <tr>
                <td>Days Needed:</td>
                <td>${totalDays} day(s)</td>
            </tr>
            <tr class="table-warning">
                <td><strong>Labor Cost:</strong></td>
                <td><strong>$${totalEmployeeCost.toFixed(2)}</strong> (@$${hourlyRate}/hr)</td>
            </tr>
            <tr>
                <td>Materials & Supplies:</td>
                <td>$${materialsCost.toFixed(2)}</td>
            </tr>
            <tr>
                <td>Estimated Taxes:</td>
                <td>$${taxes.toFixed(2)}</td>
            </tr>
            <tr class="table-success">
                <td><strong>Estimated Profit:</strong></td>
                <td><strong>$${profitMargin.toFixed(2)}</strong></td>
            </tr>
        </table>
        <div class="alert alert-secondary small">
            <strong>Payment Structure:</strong><br>
            â€¢ 50% due upon contract signing<br>
            â€¢ 50% due upon completion<br>
            â€¢ Pay employees: Daily or weekly basis
        </div>
    `;
    
    document.getElementById('postconstResults').innerHTML = html;
}

function showCommercialCleaningChecklist() {
    document.getElementById('toolModalTitle').textContent = 'Commercial Cleaning Professional';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3" style="max-height: 600px; overflow-y: auto;">
            <ul class="nav nav-tabs mb-3" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#commChecklist">Checklist</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#commPricing">Pricing & Staffing</a>
                </li>
            </ul>
            
            <div class="tab-content">
                <div class="tab-pane fade show active" id="commChecklist">
                    <h6 class="mb-3">Daily Commercial Cleaning Tasks</h6>
                    <h7 class="text-primary mb-2"><strong>Common Areas</strong></h7>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Vacuum/sweep lobby and hallways</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Empty and sanitize trash bins</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Dust surfaces and furniture</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean and disinfect restrooms</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Mop floors</div>
                    
                    <h7 class="text-primary mb-2 mt-3"><strong>Offices</strong></h7>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Dust desks and computers</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Empty office trash bins</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Vacuum carpets</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean conference room tables</div>
                </div>
                
                <div class="tab-pane fade" id="commPricing">
                    <h6 class="mb-3">Commercial Pricing Calculator</h6>
                    <div class="mb-3">
                        <label class="form-label">Square Footage</label>
                        <input type="number" class="form-control" id="commSqft" placeholder="Enter sq ft" value="10000" min="500">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Frequency</label>
                        <select class="form-select" id="commFreq">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly (5x/week)</option>
                            <option value="biweekly">Bi-Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <div id="commResults"></div>
                    <button class="btn btn-primary mt-3" onclick="calculateCommercialPricing()">Calculate</button>
                </div>
            </div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function calculateCommercialPricing() {
    const sqft = parseFloat(document.getElementById('commSqft').value) || 10000;
    const freq = document.getElementById('commFreq').value;
    
    // Commercial rates: $0.12-0.18 per sq ft per visit
    const ratePerSqft = 0.15;
    const perVisitPrice = sqft * ratePerSqft;
    
    // Frequency multiplier
    let frequencyMultiplier = 5; // daily = 5 visits/week
    if (freq === 'weekly') frequencyMultiplier = 1;
    if (freq === 'biweekly') frequencyMultiplier = 0.5;
    if (freq === 'monthly') frequencyMultiplier = 0.25;
    
    const monthlyPrice = perVisitPrice * frequencyMultiplier * 4.33; // weeks per month
    const annualPrice = monthlyPrice * 12;
    
    // Staffing
    let staffPerVisit = 1;
    if (sqft > 5000) staffPerVisit = 2;
    if (sqft > 15000) staffPerVisit = 3;
    if (sqft > 25000) staffPerVisit = 4;
    
    // Time per visit (min 2 hours per 5000 sqft)
    const timePerVisit = Math.max(2, Math.ceil(sqft / 5000) * 2);
    
    // Labor cost per visit
    const hourlyRate = 18;
    const laborPerVisit = timePerVisit * staffPerVisit * hourlyRate;
    const monthlyLabor = laborPerVisit * frequencyMultiplier * 4.33;
    
    // Materials (10% of revenue)
    const monthlyMaterials = monthlyPrice * 0.10;
    
    // Taxes (15%)
    const monthlyTaxes = monthlyPrice * 0.15;
    
    // Monthly profit
    const monthlyProfit = monthlyPrice - monthlyLabor - monthlyMaterials - monthlyTaxes;
    
    const html = `
        <div class="alert alert-info">
            <strong>Commercial Cleaning Estimate for ${sqft.toLocaleString()} sq ft:</strong>
        </div>
        <table class="table table-sm">
            <tr>
                <td><strong>Per Visit:</strong></td>
                <td><strong>$${perVisitPrice.toFixed(2)}</strong></td>
            </tr>
            <tr>
                <td>Staff per Visit:</td>
                <td>${staffPerVisit} person(s) | ${timePerVisit} hours</td>
            </tr>
            <tr class="table-warning">
                <td><strong>Monthly Revenue:</strong></td>
                <td><strong>$${monthlyPrice.toFixed(2)}</strong></td>
            </tr>
            <tr>
                <td>Monthly Labor:</td>
                <td>$${monthlyLabor.toFixed(2)}</td>
            </tr>
            <tr>
                <td>Materials & Supplies:</td>
                <td>$${monthlyMaterials.toFixed(2)}</td>
            </tr>
            <tr>
                <td>Estimated Taxes:</td>
                <td>$${monthlyTaxes.toFixed(2)}</td>
            </tr>
            <tr class="table-success">
                <td><strong>Monthly Profit:</strong></td>
                <td><strong>$${monthlyProfit.toFixed(2)}</strong></td>
            </tr>
            <tr class="table-success">
                <td><strong>Annual Revenue:</strong></td>
                <td><strong>$\${annualPrice.toFixed(2)}</strong></td>
            </tr>
        </table>
        <div class="alert alert-secondary small">
            <strong>Employee Payment:</strong><br>
            â€¢ Hourly: \$\${hourlyRate}/hour (\$\${(hourlyRate * 8).toFixed(2)}/day)<br>
            â€¢ Pay frequency: Weekly or bi-weekly
        </div>
    `;
    
    document.getElementById('commResults').innerHTML = html;
}

function showResidentialCleaningChecklist() {
    document.getElementById('toolModalTitle').textContent = 'Residential Cleaning Professional';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3" style="max-height: 600px; overflow-y: auto;">
            <ul class="nav nav-tabs mb-3" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#resChecklist">Checklist</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#resPricing">Pricing & Staffing</a>
                </li>
            </ul>
            
            <div class="tab-content">
                <div class="tab-pane fade show active" id="resChecklist">
                    <h6 class="mb-3">Residential Cleaning Tasks</h6>
                    <h7 class="text-primary mb-2"><strong>Kitchen</strong></h7>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean countertops and appliances</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Sanitize sink and faucet</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Sweep and mop floor</div>
                    
                    <h7 class="text-primary mb-2 mt-3"><strong>Bathrooms</strong></h7>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean and sanitize toilet, sink, shower</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Scrub tiles and grout</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Clean mirrors and fixtures</div>
                    
                    <h7 class="text-primary mb-2 mt-3"><strong>Living Areas</strong></h7>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Dust all surfaces</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Vacuum carpets and rugs</div>
                    <div class="form-check mb-2"><input class="form-check-input" type="checkbox"> Mop hard floors</div>
                </div>
                
                <div class="tab-pane fade" id="resPricing">
                    <h6 class="mb-3">Residential Pricing Calculator</h6>
                    <div class="mb-3">
                        <label class="form-label">Square Footage</label>
                        <input type="number" class="form-control" id="resSqft" placeholder="Enter sq ft" value="3000" min="300">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Number of Bedrooms</label>
                        <input type="number" class="form-control" id="resBeds" value="3" min="1">
                    </div>
                    <div id="resResults"></div>
                    <button class="btn btn-primary mt-3" onclick="calculateResidentialPricing()">Calculate</button>
                </div>
            </div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function calculateResidentialPricing() {
    const sqft = parseFloat(document.getElementById('resSqft').value) || 3000;
    const beds = parseInt(document.getElementById('resBeds').value) || 3;
    
    // Residential rates: $0.25-0.35 per sq ft or flat rate
    const pricePerSqft = 0.30;
    const basePrice = sqft * pricePerSqft;
    
    // Add bedroom multiplier ($50-75 per bedroom)
    const bedroomAdd = beds * 60;
    const totalPrice = basePrice + bedroomAdd;
    
    // Staffing: 1 person for 1500 sqft
    const staff = Math.max(1, Math.ceil(sqft / 1500));
    
    // Time needed: 2-3 hours per 1000 sqft
    const timeNeeded = Math.ceil((sqft / 1000) * 2.5);
    
    // Daily employee cost
    const hourlyRate = 18;
    const dailyCost = timeNeeded * hourlyRate * staff;
    
    // Materials (12% of revenue)
    const materials = totalPrice * 0.12;
    
    // Taxes (15%)
    const taxes = totalPrice * 0.15;
    
    // Profit
    const profit = totalPrice - dailyCost - materials - taxes;
    
    const html = `
        <div class="alert alert-info">
            <strong>Residential Cleaning Estimate (${sqft.toLocaleString()} sqft, ${beds} beds):</strong>
        </div>
        <table class="table table-sm">
            <tr>
                <td><strong>Base Price:</strong></td>
                <td><strong>$${totalPrice.toFixed(2)}</strong></td>
            </tr>
            <tr>
                <td colspan="2"><small>($${pricePerSqft}/sqft + $${bedroomAdd} bedroom premium)</small></td>
            </tr>
            <tr>
                <td>Staff Required:</td>
                <td>${staff} person(s)</td>
            </tr>
            <tr>
                <td>Time Needed:</td>
                <td>${timeNeeded} hours</td>
            </tr>
            <tr class="table-warning">
                <td><strong>Labor Cost:</strong></td>
                <td><strong>$${dailyCost.toFixed(2)}</strong> (@$${hourlyRate}/hr)</td>
            </tr>
            <tr>
                <td>Materials & Supplies:</td>
                <td>$${materials.toFixed(2)}</td>
            </tr>
            <tr>
                <td>Estimated Taxes:</td>
                <td>$${taxes.toFixed(2)}</td>
            </tr>
            <tr class="table-success">
                <td><strong>Estimated Profit:</strong></td>
                <td><strong>$${profit.toFixed(2)}</strong></td>
            </tr>
        </table>
        <div class="alert alert-secondary small">
            <strong>Payment Options:</strong><br>
            â€¢ Per-job basis: Pay after completion<br>
            â€¢ Recurring (weekly/bi-weekly): Weekly payments<br>
            â€¢ Employee: $${hourlyRate}/hour, paid weekly
        </div>
    `;
    
    document.getElementById('resResults').innerHTML = html;
}


function showResources() {
    document.getElementById('toolModalTitle').textContent = 'Industry Resources';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <h6>Useful Government Contracting Links:</h6>
            <div class="list-group">
                <a href="https://sam.gov" target="_blank" class="list-group-item list-group-item-action">
                    <i class="fas fa-external-link-alt me-2"></i>SAM.gov - Federal Contracts
                </a>
                <a href="https://www.sba.gov" target="_blank" class="list-group-item list-group-item-action">
                    <i class="fas fa-external-link-alt me-2"></i>SBA.gov - Small Business Administration
                </a>
                <a href="https://mvendor.cgieva.com" target="_blank" class="list-group-item list-group-item-action">
                    <i class="fas fa-external-link-alt me-2"></i>Virginia eVA - State Procurement
                </a>
                <a href="https://www.gsa.gov" target="_blank" class="list-group-item list-group-item-action">
                    <i class="fas fa-external-link-alt me-2"></i>GSA.gov - General Services Administration
                </a>
            </div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function showTimeline() {
    document.getElementById('toolModalTitle').textContent = 'Bid Timeline Template';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <h6>Typical Government Contract Timeline:</h6>
            <div class="timeline">
                <div class="alert alert-primary">
                    <strong>Day 1-3:</strong> Review RFP and requirements
                </div>
                <div class="alert alert-info">
                    <strong>Day 4-7:</strong> Prepare questions for contracting officer
                </div>
                <div class="alert alert-warning">
                    <strong>Day 8-14:</strong> Develop proposal and pricing
                </div>
                <div class="alert alert-success">
                    <strong>Day 15-17:</strong> Review and finalize submission
                </div>
                <div class="alert alert-danger">
                    <strong>Day 18:</strong> Submit proposal before deadline
                </div>
            </div>
            <p class="text-muted"><small>Adjust timeline based on RFP complexity and deadline</small></p>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function showGlossary() {
    document.getElementById('toolModalTitle').textContent = 'Contract Glossary';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <h6>Common Terms:</h6>
            <dl>
                <dt>RFP (Request for Proposal)</dt>
                <dd>Document requesting bids for a specific project or service</dd>
                
                <dt>SAM (System for Award Management)</dt>
                <dd>Official database for businesses seeking federal contracts</dd>
                
                <dt>NAICS (North American Industry Classification System)</dt>
                <dd>Code system used to classify business types</dd>
                
                <dt>SBA (Small Business Administration)</dt>
                <dd>Federal agency supporting small business development</dd>
                
                <dt>Capability Statement</dt>
                <dd>One-page overview of your company's qualifications</dd>
            </dl>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function showGuide() {
    document.getElementById('toolModalTitle').textContent = 'Getting Started Guide';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <h6>Steps to Start Winning Government Contracts:</h6>
            <ol class="list-group list-group-numbered">
                <li class="list-group-item">Register in SAM.gov (required for federal contracts)</li>
                <li class="list-group-item">Get your DUNS number from Dun & Bradstreet</li>
                <li class="list-group-item">Determine your NAICS codes</li>
                <li class="list-group-item">Create a professional capability statement</li>
                <li class="list-group-item">Research opportunities on government portals</li>
                <li class="list-group-item">Start with smaller contracts to build experience</li>
                <li class="list-group-item">Network with other contractors and agencies</li>
                <li class="list-group-item">Keep detailed records of past performance</li>
            </ol>
            <div class="alert alert-success mt-3">
                <small><i class="fas fa-lightbulb me-2"></i>Sign up for personalized guidance and templates!</small>
            </div>
        </div>
    `;
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function showInvoiceCreator() {
    document.getElementById('toolModalTitle').textContent = 'Invoice Creator';
    document.getElementById('toolModalBody').innerHTML = `
        <div class="p-3">
            <form id="invoiceForm">
                <div class="mb-3">
                    <label for="invoiceName" class="form-label">Invoice Name</label>
                    <input type="text" class="form-control" id="invoiceName" placeholder="e.g., Project ABC Cleaning" required>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="invoiceDate" class="form-label">Invoice Date</label>
                            <input type="date" class="form-control" id="invoiceDate" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="dueDate" class="form-label">Due Date</label>
                            <input type="date" class="form-control" id="dueDate" required>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="billTo" class="form-label">Bill To (Client Name)</label>
                            <input type="text" class="form-control" id="billTo" placeholder="Client/Company name" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="yourCompany" class="form-label">Your Company Name</label>
                            <input type="text" class="form-control" id="yourCompany" placeholder="Your company name" required>
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Invoice Items</label>
                    <div id="invoiceItems">
                        <div class="invoice-item mb-2">
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <input type="text" class="form-control item-description" placeholder="Item description">
                                </div>
                                <div class="col-md-3">
                                    <input type="number" class="form-control item-qty" placeholder="Qty" min="1" value="1" step="0.01">
                                </div>
                                <div class="col-md-3">
                                    <input type="number" class="form-control item-price" placeholder="Price" min="0" step="0.01">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-sm btn-outline-primary mt-2" onclick="addInvoiceItem()">
                        <i class="fas fa-plus me-2"></i>Add Item
                    </button>
                </div>

                <div class="row mt-4">
                    <div class="col-md-8"></div>
                    <div class="col-md-4">
                        <div class="d-flex justify-content-between mb-2">
                            <strong>Subtotal:</strong>
                            <span id="subtotal">$0.00</span>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <strong>Total:</strong>
                            <strong id="totalAmount">$0.00</strong>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info small">
                    <i class="fas fa-info-circle me-2"></i>Add notes or terms in the optional field below
                </div>

                <div class="mb-3">
                    <label for="invoiceNotes" class="form-label">Notes/Terms (Optional)</label>
                    <textarea class="form-control" id="invoiceNotes" rows="3" placeholder="Payment terms, thank you note, etc."></textarea>
                </div>

                <div class="d-flex gap-2 flex-wrap">
                    <button type="button" class="btn btn-success" onclick="saveInvoiceToProfile()">
                        <i class="fas fa-save me-2"></i>Save to Profile
                    </button>
                    <button type="button" class="btn btn-primary" onclick="generateInvoicePDF()">
                        <i class="fas fa-file-pdf me-2"></i>Download PDF
                    </button>
                    <button type="button" class="btn btn-info" onclick="emailInvoice()">
                        <i class="fas fa-envelope me-2"></i>Email Invoice
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Close
                    </button>
                </div>
            </form>
        </div>
    `;
    
    // Set today's date as default
    const today = new Date().toISOString().split('T')[0];
    setTimeout(() => {
        document.getElementById('invoiceDate').value = today;
        document.getElementById('dueDate').value = today;
        
        // Add event listeners to first item inputs
        const firstItemQty = document.querySelector('.invoice-item .item-qty');
        const firstItemPrice = document.querySelector('.invoice-item .item-price');
        if (firstItemQty) firstItemQty.addEventListener('input', updateInvoiceTotal);
        if (firstItemPrice) firstItemPrice.addEventListener('input', updateInvoiceTotal);
    }, 100);
    
    new bootstrap.Modal(document.getElementById('toolModal')).show();
}

function addInvoiceItem() {
    const itemsContainer = document.getElementById('invoiceItems');
    const newItem = document.createElement('div');
    newItem.className = 'invoice-item mb-2';
    newItem.innerHTML = `
        <div class="row g-2">
            <div class="col-md-6">
                <input type="text" class="form-control item-description" placeholder="Item description">
            </div>
            <div class="col-md-3">
                <input type="number" class="form-control item-qty" placeholder="Qty" min="1" value="1" step="0.01">
            </div>
            <div class="col-md-3">
                <div class="input-group">
                    <input type="number" class="form-control item-price" placeholder="Price" min="0" step="0.01">
                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="this.parentElement.parentElement.parentElement.remove(); updateInvoiceTotal()">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        </div>
    `;
    itemsContainer.appendChild(newItem);
    
    // Add event listeners for calculation
    newItem.querySelectorAll('.item-qty, .item-price').forEach(input => {
        input.addEventListener('input', updateInvoiceTotal);
    });
}

function updateInvoiceTotal() {
    let subtotal = 0;
    document.querySelectorAll('.invoice-item').forEach(item => {
        const qty = parseFloat(item.querySelector('.item-qty').value) || 0;
        const price = parseFloat(item.querySelector('.item-price').value) || 0;
        subtotal += qty * price;
    });
    
    document.getElementById('subtotal').textContent = '$' + subtotal.toFixed(2);
    document.getElementById('totalAmount').textContent = '$' + subtotal.toFixed(2);
}

function saveInvoiceToProfile() {
    const invoiceData = getInvoiceData();
    
    if (!invoiceData.invoiceName || !invoiceData.billTo || !invoiceData.items.length) {
        alert('Please fill in all required fields and add at least one item.');
        return;
    }
    
    fetch('/api/save-invoice', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(invoiceData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Invoice saved to your profile successfully!');
            bootstrap.Modal.getInstance(document.getElementById('toolModal')).hide();
        } else {
            alert('Error saving invoice: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error saving invoice');
    });
}

function generateInvoicePDF() {
    const invoiceData = getInvoiceData();
    
    if (!invoiceData.invoiceName || !invoiceData.items.length) {
        alert('Please fill in invoice details and add at least one item.');
        return;
    }
    
    fetch('/api/generate-invoice-pdf', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(invoiceData)
    })
    .then(response => response.blob())
    .then(blob => {
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = (invoiceData.invoiceName || 'invoice') + '.pdf';
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        a.remove();
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error generating PDF');
    });
}

function emailInvoice() {
    const invoiceData = getInvoiceData();
    
    if (!invoiceData.invoiceName || !invoiceData.items.length) {
        alert('Please fill in invoice details and add at least one item.');
        return;
    }
    
    const email = prompt('Enter email address to send invoice to:', '');
    if (!email) return;
    
    invoiceData.email = email;
    
    fetch('/api/email-invoice', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(invoiceData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Invoice sent successfully to ' + email);
        } else {
            alert('Error sending invoice: ' + data.message);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error sending invoice');
    });
}

function getInvoiceData() {
    const items = [];
    document.querySelectorAll('.invoice-item').forEach(item => {
        const description = item.querySelector('.item-description').value;
        const qty = parseFloat(item.querySelector('.item-qty').value) || 0;
        const price = parseFloat(item.querySelector('.item-price').value) || 0;
        
        if (description && qty && price) {
            items.push({
                description: description,
                quantity: qty,
                unitPrice: price,
                amount: qty * price
            });
        }
    });
    
    const total = items.reduce((sum, item) => sum + item.amount, 0);
    
    return {
        invoiceName: document.getElementById('invoiceName').value,
        invoiceDate: document.getElementById('invoiceDate').value,
        dueDate: document.getElementById('dueDate').value,
        billTo: document.getElementById('billTo').value,
        yourCompany: document.getElementById('yourCompany').value,
        items: items,
        notes: document.getElementById('invoiceNotes').value,
        total: total
    };
}

</script>

{% endblock %}
