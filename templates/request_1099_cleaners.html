{% extends "base.html" %}

{% block title %}Request 1099 Cleaners - Post Your Cleaning Job{% endblock %}

{% block content %}
<div class="container my-5">
    <!-- Hero Section -->
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold text-primary mb-3">
            <i class="fas fa-users me-2"></i>Request 1099 Subcontract Cleaners
        </h1>
        <p class="lead text-muted mb-4">
            Post your cleaning job and connect with qualified independent contractors
        </p>
        <div class="alert alert-info mx-auto" style="max-width: 800px;">
            <i class="fas fa-info-circle me-2"></i>
            <strong>How it works:</strong> Submit your request below â†’ Admin reviews within 24 hours â†’ Once approved, your posting goes live in our Community Forum where 1099 cleaners can view and respond
        </div>
    </div>

    <!-- Main Form Card -->
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-header text-white py-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h4 class="mb-0">
                        <i class="fas fa-clipboard-list me-2"></i>Job Request Details
                    </h4>
                </div>
                <div class="card-body p-4">
                    <form id="cleanerRequestForm" method="POST">
                        <!-- Company Information Section -->
                        <h5 class="border-bottom pb-2 mb-4">
                            <i class="fas fa-building me-2 text-primary"></i>Company Information
                        </h5>
                        
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="companyName" class="form-label fw-bold">
                                    Company Name <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="companyName" name="companyName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="contactName" class="form-label fw-bold">
                                    Contact Person <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="contactName" name="contactName" required>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="email" class="form-label fw-bold">
                                    Email Address <span class="text-danger">*</span>
                                </label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="col-md-6">
                                <label for="phone" class="form-label fw-bold">
                                    Phone Number <span class="text-danger">*</span>
                                </label>
                                <input type="tel" class="form-control" id="phone" name="phone" placeholder="(555) 123-4567" required>
                            </div>
                        </div>

                        <!-- Location Section -->
                        <h5 class="border-bottom pb-2 mb-4 mt-4">
                            <i class="fas fa-map-marker-alt me-2 text-success"></i>Job Location
                        </h5>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="city" class="form-label fw-bold">
                                    City <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="city" name="city" required>
                            </div>
                            <div class="col-md-6">
                                <label for="state" class="form-label fw-bold">
                                    State <span class="text-danger">*</span>
                                </label>
                                <select class="form-select" id="state" name="state" required>
                                    <option value="">Select State</option>
                                    <option value="AL">Alabama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="DC">District of Columbia</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="VA" selected>Virginia</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                            </div>
                        </div>

                        <!-- Job Details Section -->
                        <h5 class="border-bottom pb-2 mb-4 mt-4">
                            <i class="fas fa-briefcase me-2 text-warning"></i>Job Details
                        </h5>

                        <div class="mb-4">
                            <label for="serviceCategory" class="form-label fw-bold">
                                Service Category <span class="text-danger">*</span>
                            </label>
                            <select class="form-select" id="serviceCategory" name="serviceCategory" required>
                                <option value="">Select Service Type</option>
                                <option value="Office Cleaning">Office Cleaning</option>
                                <option value="Janitorial Services">Janitorial Services</option>
                                <option value="Post-Construction Cleanup">Post-Construction Cleanup</option>
                                <option value="Airbnb/Vacation Rental">Airbnb/Vacation Rental Turnover</option>
                                <option value="Medical Facility Cleaning">Medical Facility Cleaning</option>
                                <option value="School/Education Cleaning">School/Education Cleaning</option>
                                <option value="Retail Cleaning">Retail Store Cleaning</option>
                                <option value="Restaurant Cleaning">Restaurant/Food Service Cleaning</option>
                                <option value="Industrial Cleaning">Industrial/Warehouse Cleaning</option>
                                <option value="Event Cleanup">Event/Special Event Cleanup</option>
                                <option value="Move-In/Move-Out">Move-In/Move-Out Cleaning</option>
                                <option value="Deep Cleaning">Deep Cleaning Services</option>
                                <option value="Floor Care">Floor Care/Stripping/Waxing</option>
                                <option value="Window Cleaning">Window Cleaning</option>
                                <option value="Carpet Cleaning">Carpet Cleaning</option>
                                <option value="Other">Other (Specify in Description)</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label for="description" class="form-label fw-bold">
                                Job Description <span class="text-danger">*</span>
                            </label>
                            <textarea class="form-control" id="description" name="description" rows="5" 
                                      placeholder="Describe the cleaning job, square footage, frequency, specific requirements, etc." 
                                      required></textarea>
                            <small class="text-muted">Be specific about square footage, cleaning frequency, special requirements, etc.</small>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="payRate" class="form-label fw-bold">
                                    Pay Rate <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="payRate" name="payRate" 
                                       placeholder="$25/hour or $500/job" required>
                                <small class="text-muted">e.g., "$20-25/hour" or "$500/month"</small>
                            </div>
                            <div class="col-md-6">
                                <label for="startDate" class="form-label fw-bold">
                                    Start Date <span class="text-danger">*</span>
                                </label>
                                <input type="date" class="form-control" id="startDate" name="startDate" required>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="urgency" class="form-label fw-bold">
                                Urgency Level <span class="text-danger">*</span>
                            </label>
                            <select class="form-select" id="urgency" name="urgency" required>
                                <option value="">Select Urgency</option>
                                <option value="urgent">ðŸ”´ Urgent - Need ASAP (within 1-3 days)</option>
                                <option value="high">ðŸŸ¡ High Priority - Within 1 week</option>
                                <option value="normal">ðŸŸ¢ Normal - Within 2-4 weeks</option>
                            </select>
                        </div>

                        <!-- Requirements Section -->
                        <h5 class="border-bottom pb-2 mb-4 mt-4">
                            <i class="fas fa-clipboard-check me-2 text-danger"></i>Requirements
                        </h5>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    Background Check Required? <span class="text-danger">*</span>
                                </label>
                                <div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="backgroundCheckRequired" 
                                               id="bgCheckYes" value="yes" required>
                                        <label class="form-check-label" for="bgCheckYes">Yes</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="backgroundCheckRequired" 
                                               id="bgCheckNo" value="no" required>
                                        <label class="form-check-label" for="bgCheckNo">No</label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">
                                    Equipment/Supplies Provided? <span class="text-danger">*</span>
                                </label>
                                <div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="equipmentRequired" 
                                               id="equipYes" value="yes" required>
                                        <label class="form-check-label" for="equipYes">Yes, Provided</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="equipmentRequired" 
                                               id="equipNo" value="no" required>
                                        <label class="form-check-label" for="equipNo">No, Cleaner Must Provide</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Terms & Conditions -->
                        <div class="alert alert-light border">
                            <h6 class="fw-bold">ðŸ“‹ Before You Submit:</h6>
                            <ul class="mb-0 small">
                                <li>Your request will be reviewed by our admin team within 24 hours</li>
                                <li>Once approved, it will be posted to our Community Forum where 1099 cleaners can view it</li>
                                <li>You'll receive email notifications when cleaners respond</li>
                                <li><strong>Subscribers only:</strong> Full contact details are only visible to paid subscribers</li>
                                <li>This is a FREE service for posting. No credit card required.</li>
                            </ul>
                        </div>

                        <!-- Submit Button -->
                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                                <i class="fas fa-paper-plane me-2"></i>Submit Request for Review
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Success/Error Messages -->
            <div id="successMessage" class="alert alert-success mt-4 d-none" role="alert">
                <h5><i class="fas fa-check-circle me-2"></i>Request Submitted Successfully!</h5>
                <p class="mb-0">Your 1099 cleaner request has been submitted for admin review. You'll receive an email notification within 24 hours once it's approved and posted to the Community Forum.</p>
            </div>

            <div id="errorMessage" class="alert alert-danger mt-4 d-none" role="alert">
                <h5><i class="fas fa-exclamation-triangle me-2"></i>Submission Error</h5>
                <p class="mb-0" id="errorText"></p>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('cleanerRequestForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Submitting...';
    
    // Collect form data
    const formData = {
        companyName: document.getElementById('companyName').value,
        contactName: document.getElementById('contactName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        city: document.getElementById('city').value,
        state: document.getElementById('state').value,
        serviceCategory: document.getElementById('serviceCategory').value,
        description: document.getElementById('description').value,
        payRate: document.getElementById('payRate').value,
        startDate: document.getElementById('startDate').value,
        urgency: document.getElementById('urgency').value,
        backgroundCheckRequired: document.querySelector('input[name="backgroundCheckRequired"]:checked').value,
        equipmentRequired: document.querySelector('input[name="equipmentRequired"]:checked').value
    };
    
    // Submit to API
    fetch('/api/1099-cleaner-requests/create', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Show success message
            document.getElementById('successMessage').classList.remove('d-none');
            document.getElementById('errorMessage').classList.add('d-none');
            
            // Reset form
            document.getElementById('cleanerRequestForm').reset();
            
            // Scroll to success message
            document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth' });
        } else {
            // Show error message
            document.getElementById('errorMessage').classList.remove('d-none');
            document.getElementById('successMessage').classList.add('d-none');
            document.getElementById('errorText').textContent = data.error || 'An error occurred. Please try again.';
            
            document.getElementById('errorMessage').scrollIntoView({ behavior: 'smooth' });
        }
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('errorMessage').classList.remove('d-none');
        document.getElementById('successMessage').classList.add('d-none');
        document.getElementById('errorText').textContent = 'Network error. Please check your connection and try again.';
        
        document.getElementById('errorMessage').scrollIntoView({ behavior: 'smooth' });
    })
    .finally(() => {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
    });
});

// Set minimum date to today
document.getElementById('startDate').min = new Date().toISOString().split('T')[0];
</script>

{% endblock %}
