{% extends 'base.html' %}

{% block title %}One-on-One Consultations - Government Cleaning Contracts{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-5 fw-bold text-primary mb-2">
                <i class="fas fa-user-tie me-2"></i>One-on-One Consultations
            </h1>
            <p class="lead text-muted">Get personalized expert guidance for your cleaning business</p>
            <a href="{{ url_for('customer_leads') }}" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left me-2"></i>Back to Portal
            </a>
        </div>
    </div>

    {% if not is_subscriber %}
    <!-- Non-Subscriber Paywall -->
    <div class="row">
        <div class="col-12">
            <div class="card border-warning shadow-lg">
                <div class="card-body text-center py-5">
                    <div class="mb-4">
                        <i class="fas fa-lock fa-5x text-warning"></i>
                    </div>
                    <h2 class="text-warning mb-3">Subscriber Exclusive Benefit</h2>
                    <p class="lead mb-4">Upgrade to unlock personalized consultation sessions:</p>
                    <div class="row justify-content-center mb-4">
                        <div class="col-md-8">
                            <ul class="list-unstyled text-start">
                                <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>One-on-one video calls with experienced contractors</li>
                                <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Proposal review and feedback sessions</li>
                                <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Bidding strategy development</li>
                                <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Business growth coaching</li>
                                <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Flexible scheduling to fit your calendar</li>
                                <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Follow-up email summaries after each session</li>
                            </ul>
                        </div>
                    </div>
                    <a href="{{ url_for('payment') }}" class="btn btn-warning btn-lg px-5">
                        <i class="fas fa-star me-2"></i>Upgrade to Pro Access
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <!-- Subscriber Content -->
    
    <!-- Your Assigned Specialist Section -->
    <div class="row mb-5">
        <div class="col-12">
            <div class="card shadow-lg border-0" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="card-body text-white p-4">
                    <div class="row align-items-center">
                        <div class="col-md-3 text-center mb-3 mb-md-0">
                            <div class="specialist-avatar mx-auto mb-3">
                                <i class="fas fa-user-tie fa-5x"></i>
                            </div>
                            <div class="badge bg-light text-primary px-3 py-2">
                                <i class="fas fa-star me-1"></i>Your Specialist
                            </div>
                        </div>
                        <div class="col-md-9">
                            <h2 class="mb-2">{{ specialist.name }}</h2>
                            <h5 class="mb-3 text-white-50">{{ specialist.title }}</h5>
                            <p class="mb-3">Welcome, {{ user_name }}! {{ specialist.name }} is your dedicated proposal support specialist, ready to help you win government contracts.</p>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <h6 class="mb-2"><i class="fas fa-check-circle me-2"></i>Areas of Expertise:</h6>
                                    <ul class="list-unstyled ms-3">
                                        {% for expertise in specialist.expertise %}
                                        <li class="mb-1"><i class="fas fa-chevron-right me-2 small"></i>{{ expertise }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="mb-2"><i class="fas fa-clock me-2"></i>Availability:</h6>
                                    <p class="ms-3 mb-3">{{ specialist.availability }}</p>
                                    
                                    <h6 class="mb-2"><i class="fas fa-envelope me-2"></i>Direct Contact:</h6>
                                    <p class="ms-3">
                                        <a href="mailto:{{ specialist.email }}" class="text-white text-decoration-none">
                                            <strong>{{ specialist.email }}</strong>
                                            <i class="fas fa-external-link-alt ms-2 small"></i>
                                        </a>
                                    </p>
                                </div>
                            </div>
                            
                            <div class="d-flex gap-2 flex-wrap">
                                <a href="mailto:{{ specialist.email }}" class="btn btn-light btn-lg">
                                    <i class="fas fa-envelope me-2"></i>Email Ray
                                </a>
                                <button class="btn btn-outline-light btn-lg" onclick="scrollToSchedule()">
                                    <i class="fas fa-calendar-alt me-2"></i>Schedule Consultation
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-info">
                <h5 class="alert-heading"><i class="fas fa-info-circle me-2"></i>How to Connect with Ray</h5>
                <p class="mb-0">Choose a consultation type below to schedule a video call, or email Ray directly at <strong>{{ specialist.email }}</strong> for quick questions. All sessions include follow-up notes and action items.</p>
            </div>
        </div>
    </div>

    <!-- Consultation Types -->
    <div id="schedule-section" class="row g-4 mb-5">
        <div class="col-12">
            <h3 class="mb-4"><i class="fas fa-calendar-check me-2 text-primary"></i>Schedule Your Consultation</h3>
        </div>
        {% for consult in consultation_types %}
        <div class="col-12 col-md-6">
            <div class="card h-100 shadow-sm hover-card border-{{ consult.color }} border-3">
                <div class="card-body p-4">
                    <div class="d-flex align-items-start mb-3">
                        <div class="icon-box bg-{{ consult.color }} bg-opacity-10 rounded-circle p-3 me-3">
                            <i class="fas {{ consult.icon }} fa-2x text-{{ consult.color }}"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h4 class="card-title mb-1">{{ consult.title }}</h4>
                            <p class="text-muted mb-2">
                                <i class="far fa-clock me-1"></i>{{ consult.duration }}
                            </p>
                            <p class="card-text">{{ consult.description }}</p>
                        </div>
                    </div>
                    <div class="d-grid">
                        <button class="btn btn-{{ consult.color }} btn-lg" onclick="scheduleConsultation('{{ consult.title }}', '{{ consult.duration }}')">
                            <i class="fas fa-calendar-plus me-2"></i>Schedule Now
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- How It Works -->
    <div class="row mb-5">
        <div class="col-12">
            <h3 class="text-center mb-4">How It Works</h3>
        </div>
        <div class="col-md-3 mb-3">
            <div class="text-center">
                <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center mb-3" style="width: 60px; height: 60px;">
                    <h3 class="mb-0">1</h3>
                </div>
                <h5>Choose Session Type</h5>
                <p class="text-muted">Select the consultation that fits your needs</p>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="text-center">
                <div class="rounded-circle bg-success text-white d-inline-flex align-items-center justify-content-center mb-3" style="width: 60px; height: 60px;">
                    <h3 class="mb-0">2</h3>
                </div>
                <h5>Pick a Time</h5>
                <p class="text-muted">View available slots and book what works for you</p>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="text-center">
                <div class="rounded-circle bg-info text-white d-inline-flex align-items-center justify-content-center mb-3" style="width: 60px; height: 60px;">
                    <h3 class="mb-0">3</h3>
                </div>
                <h5>Get Confirmation</h5>
                <p class="text-muted">Receive calendar invite and video call link</p>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="text-center">
                <div class="rounded-circle bg-warning text-white d-inline-flex align-items-center justify-content-center mb-3" style="width: 60px; height: 60px;">
                    <h3 class="mb-0">4</h3>
                </div>
                <h5>Join the Call</h5>
                <p class="text-muted">Meet with your expert at the scheduled time</p>
            </div>
        </div>
    </div>

    <!-- Testimonials -->
    <div class="row mb-5">
        <div class="col-12">
            <h3 class="text-center mb-4">What Subscribers Say</h3>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card h-100 bg-light border-0">
                <div class="card-body">
                    <div class="mb-3">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <p class="card-text fst-italic">"The proposal review session was invaluable. The expert caught issues I never would have noticed and helped me win my first federal contract!"</p>
                    <p class="mb-0"><strong>- Sarah M., Cleaning Business Owner</strong></p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card h-100 bg-light border-0">
                <div class="card-body">
                    <div class="mb-3">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <p class="card-text fst-italic">"I had so many questions about bidding strategy. The consultation gave me a clear roadmap and confidence to pursue larger contracts."</p>
                    <p class="mb-0"><strong>- James T., Commercial Cleaner</strong></p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card h-100 bg-light border-0">
                <div class="card-body">
                    <div class="mb-3">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <p class="card-text fst-italic">"The business development coaching helped me scale from 2 contracts to 8 in just 6 months. Worth every penny of my subscription!"</p>
                    <p class="mb-0"><strong>- Maria R., Facility Services</strong></p>
                </div>
            </div>
        </div>
    </div>

    <!-- FAQ -->
    <div class="row mb-5">
        <div class="col-lg-8 mx-auto">
            <h3 class="text-center mb-4">Frequently Asked Questions</h3>
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                            How many consultations can I schedule per month?
                        </button>
                    </h2>
                    <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Pro subscribers can schedule up to 2 consultations per month at no additional cost. Additional sessions available at discounted rates.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                            Who is Ray Matthews?
                        </button>
                    </h2>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Ray Matthews is your dedicated Proposal Support Specialist with extensive experience in government contracting and cleaning business development. Ray works exclusively with our Pro members to help them win more contracts through personalized guidance, proposal reviews, and strategic coaching. You can reach Ray directly at <a href="mailto:{{ specialist.email }}">{{ specialist.email }}</a>.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                            Can I reschedule or cancel?
                        </button>
                    </h2>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Yes! You can reschedule or cancel up to 24 hours before your appointment with no penalty. Please provide at least 24 hours notice.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                            What if I need more time?
                        </button>
                    </h2>
                    <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            You can book back-to-back sessions or extend your session time for an additional fee. Just let us know your needs when scheduling.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CTA -->
    <div class="row">
        <div class="col-12">
            <div class="alert alert-primary text-center border-0 shadow">
                <h5 class="alert-heading"><i class="fas fa-headset me-2"></i>Need Help Right Now?</h5>
                <p class="mb-3">Have urgent questions? Contact Ray Matthews directly for immediate assistance.</p>
                <a href="mailto:{{ specialist.email }}" class="btn btn-primary btn-lg">
                    <i class="fas fa-envelope me-2"></i>Email Ray Matthews
                </a>
                <p class="mt-3 mb-0 small text-muted">
                    <i class="fas fa-clock me-1"></i>Typical response time: Within 24 hours on business days
                </p>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<style>
.hover-card {
    transition: transform 0.2s, box-shadow 0.2s;
}
.hover-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.2) !important;
}
.icon-box {
    width: 70px;
    height: 70px;
    display: flex;
    align-items: center;
    justify-content: center;
}
.specialist-avatar {
    width: 120px;
    height: 120px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 4px solid rgba(255,255,255,0.5);
}
</style>

<script>
function scrollToSchedule() {
    document.getElementById('schedule-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function scheduleConsultation(type, duration) {
    // Show booking information with Ray Matthews contact
    const message = `📅 Schedule Consultation with Ray Matthews\n\n` +
          `Type: ${type}\n` +
          `Duration: ${duration}\n` +
          `Specialist: Ray Matthews\n` +
          `Email: RayMatthews@sparkbiz.co\n\n` +
          `To schedule your consultation:\n\n` +
          `1. Email Ray directly at RayMatthews@sparkbiz.co\n` +
          `2. Mention the consultation type: "${type}"\n` +
          `3. Provide 2-3 preferred time slots\n` +
          `4. Ray will send you a calendar invite and video call link\n\n` +
          `Or click "Email Ray" below to start your message now.`;
    
    if (confirm(message + '\n\nWould you like to email Ray now?')) {
        const subject = encodeURIComponent(`Consultation Request: ${type}`);
        const body = encodeURIComponent(
            `Hi Ray,\n\n` +
            `I would like to schedule a ${type} consultation (${duration}).\n\n` +
            `My preferred times are:\n` +
            `1. [Your first preference]\n` +
            `2. [Your second preference]\n` +
            `3. [Your third preference]\n\n` +
            `Topics I'd like to discuss:\n` +
            `[Please add your specific topics or questions here]\n\n` +
            `Thank you!\n` +
            `[Your name]`
        );
        window.location.href = `mailto:RayMatthews@sparkbiz.co?subject=${subject}&body=${body}`;
    }
}
</script>
{% endblock %}
