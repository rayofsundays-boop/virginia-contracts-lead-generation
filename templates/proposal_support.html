{% extends "base.html" %}

{% block title %}Proposal Support Services - VA Contracts Lead Generation{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Hero Section -->
    <div class="hero-section text-white py-5 px-4 rounded-3 mb-5" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
        <div class="text-center">
            <h1 class="display-2 fw-bold mb-3" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                üìù Proposal Support Services
            </h1>
            <p class="lead mb-0">Expert guidance to help you win more government contracts</p>
        </div>
    </div>

    <!-- Pricing Structure -->
    <div class="row mb-5">
        <div class="col-lg-10 mx-auto">
            <h2 class="text-center mb-5">Proposal Review Services</h2>
            
            <div class="row g-4">
                <!-- Standard Review -->
                <div class="col-md-6">
                    <div class="card h-100 border-primary shadow-lg">
                        <div class="card-header bg-primary text-white text-center py-3">
                            <h3 class="mb-0">Standard Review</h3>
                            <p class="mb-0 small">Up to 20 pages</p>
                        </div>
                        <div class="card-body p-4">
                            <div class="text-center mb-4">
                                <div class="display-4 fw-bold text-primary">$299</div>
                                <p class="text-muted">per proposal</p>
                            </div>
                            
                            <ul class="list-unstyled mb-4">
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Comprehensive compliance review</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Technical approach analysis</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Pricing strategy recommendations</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Grammar and formatting check</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Detailed written feedback report</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>3-5 business day turnaround</li>
                            </ul>
                            
                            <div class="alert alert-info small mb-3">
                                <strong>Perfect for:</strong> Single solicitations, straightforward requirements, proposals under 20 pages
                            </div>
                            
                            <button class="btn btn-primary w-100 btn-lg" onclick="selectServiceLevel('standard')">
                                Select Standard Review
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Premium Consultation -->
                <div class="col-md-6">
                    <div class="card h-100 border-warning shadow-lg position-relative">
                        <div class="position-absolute top-0 start-50 translate-middle">
                            <span class="badge bg-warning text-dark px-4 py-2">MOST POPULAR</span>
                        </div>
                        <div class="card-header bg-warning text-dark text-center py-3">
                            <h3 class="mb-0">Premium Consultation</h3>
                            <p class="mb-0 small">20+ pages or complex proposals</p>
                        </div>
                        <div class="card-body p-4">
                            <div class="text-center mb-4">
                                <div class="display-4 fw-bold text-warning">$599</div>
                                <p class="text-muted">2-hour consultation + review</p>
                            </div>
                            
                            <ul class="list-unstyled mb-4">
                                <li class="mb-3"><i class="fas fa-star text-warning me-2"></i><strong>Everything in Standard, plus:</strong></li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>2-hour one-on-one consultation</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Live proposal review session</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Unlimited page count</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Real-time editing guidance</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Win strategy development</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>Follow-up email support (7 days)</li>
                                <li class="mb-3"><i class="fas fa-check-circle text-success me-2"></i>2-3 business day turnaround</li>
                            </ul>
                            
                            <div class="alert alert-warning small mb-3">
                                <strong>Perfect for:</strong> Complex solicitations, multi-volume proposals, high-value contracts ($500K+)
                            </div>
                            
                            <button class="btn btn-warning w-100 btn-lg text-dark" onclick="selectServiceLevel('premium')">
                                Select Premium Consultation
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add-On Services -->
    <div class="row mb-5">
        <div class="col-lg-10 mx-auto">
            <h3 class="text-center mb-4">Add-On Services</h3>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center">
                            <i class="fas fa-paint-brush text-primary mb-3" style="font-size: 2.5rem;"></i>
                            <h5 class="card-title">Branding & Graphics</h5>
                            <p class="card-text">Professional cover pages, graphics, and branded templates</p>
                            <div class="h4 text-primary mb-3">+$149</div>
                            <ul class="list-unstyled small text-start">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Custom cover page design</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Branded proposal template</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Charts and infographics</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Professional formatting</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center">
                            <i class="fas fa-bullhorn text-success mb-3" style="font-size: 2.5rem;"></i>
                            <h5 class="card-title">Marketing Materials</h5>
                            <p class="card-text">Capability statements, one-pagers, and marketing collateral</p>
                            <div class="h4 text-success mb-3">+$199</div>
                            <ul class="list-unstyled small text-start">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Capability statement design</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Company one-pager</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Past performance summaries</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Print-ready files (PDF/Word)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center">
                            <i class="fas fa-rocket text-warning mb-3" style="font-size: 2.5rem;"></i>
                            <h5 class="card-title">Full Service Package</h5>
                            <p class="card-text">Complete proposal development from start to finish</p>
                            <div class="h4 text-warning mb-3">Custom Quote</div>
                            <ul class="list-unstyled small text-start">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>End-to-end proposal writing</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Technical volume development</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Pricing volume support</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Unlimited revisions</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Consultation Request Form -->
    <div class="row mb-5" id="consultationFormSection">
        <div class="col-lg-8 mx-auto">
            <div class="card shadow-lg border-0">
                <div class="card-body p-5">
                    <h3 class="text-center mb-4">Request a Consultation</h3>
                    
                    <!-- Selected Service Display -->
                    <div id="selectedServiceDisplay" class="alert alert-info d-none mb-4">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Selected Service: </strong>
                                <span id="selectedServiceName"></span>
                            </div>
                            <div>
                                <strong>Base Price: </strong>
                                <span id="selectedServicePrice" class="h5 mb-0"></span>
                            </div>
                        </div>
                    </div>
                    
                    <form id="consultationForm" onsubmit="submitConsultation(event)">
                        <!-- Service Level -->
                        <input type="hidden" id="serviceLevel" name="serviceLevel" value="">
                        <input type="hidden" id="basePrice" name="basePrice" value="0">
                        
                        <!-- Contact Information -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Full Name *</label>
                                <input type="text" class="form-control form-control-lg" name="fullName" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Company Name *</label>
                                <input type="text" class="form-control form-control-lg" name="companyName" required>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Email Address *</label>
                                <input type="email" class="form-control form-control-lg" name="email" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Phone Number *</label>
                                <input type="tel" class="form-control form-control-lg" name="phone" required>
                            </div>
                        </div>

                        <!-- Proposal Details -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">Solicitation Number (if available)</label>
                            <input type="text" class="form-control form-control-lg" name="solicitationNumber" 
                                   placeholder="e.g., 36C10X24Q0123">
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Contract Type *</label>
                            <select class="form-select form-select-lg" name="contractType" required>
                                <option value="">Select type...</option>
                                <option value="federal">Federal Government</option>
                                <option value="state">State Government</option>
                                <option value="local">Local Government</option>
                                <option value="commercial">Commercial</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Estimated Proposal Length *</label>
                            <select class="form-select form-select-lg" name="proposalLength" required>
                                <option value="">Select length...</option>
                                <option value="1-10">1-10 pages</option>
                                <option value="11-20">11-20 pages</option>
                                <option value="21-50">21-50 pages (requires Premium)</option>
                                <option value="50+">50+ pages (requires Premium)</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold">Submission Deadline *</label>
                            <input type="date" class="form-control form-control-lg" name="deadline" required>
                        </div>

                        <!-- Add-Ons -->
                        <div class="mb-4">
                            <label class="form-label fw-bold d-block mb-3">Additional Services Needed</label>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="addBranding" id="addBranding">
                                <label class="form-check-label" for="addBranding">
                                    Branding & Graphics (+$149)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="addMarketing" id="addMarketing">
                                <label class="form-check-label" for="addMarketing">
                                    Marketing Materials (+$199)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" name="addFullService" id="addFullService">
                                <label class="form-check-label" for="addFullService">
                                    Full Service Package (Custom Quote)
                                </label>
                            </div>
                        </div>

                        <!-- Project Description -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Project Description *</label>
                            <textarea class="form-control" name="description" rows="5" required
                                      placeholder="Tell us about your proposal needs, specific challenges, and what support you're looking for..."></textarea>
                        </div>

                        <!-- Preferred Contact Method -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Preferred Contact Method *</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod" value="email" id="contactEmail" checked>
                                <label class="form-check-label" for="contactEmail">Email</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod" value="phone" id="contactPhone">
                                <label class="form-check-label" for="contactPhone">Phone</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="contactMethod" value="both" id="contactBoth">
                                <label class="form-check-label" for="contactBoth">Either Email or Phone</label>
                            </div>
                        </div>

                        <!-- Estimated Total -->
                        <div class="alert alert-light border">
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="fw-bold">Estimated Total:</span>
                                <span class="h3 mb-0 text-primary" id="estimatedTotal">$0</span>
                            </div>
                            <small class="text-muted d-block mt-2">
                                <i class="fas fa-info-circle me-1"></i>
                                Final pricing confirmed during checkout
                            </small>
                        </div>

                        <!-- Submit Button -->
                        <button type="submit" class="btn btn-success btn-lg w-100 fw-bold">
                            <i class="fas fa-lock me-2"></i>Proceed to Secure Payment
                        </button>
                        <p class="text-center text-muted small mt-2">
                            <i class="fas fa-shield-alt me-1"></i>Secure payment via PayPal, Credit Card, or Stripe
                        </p>
                    </form>

                    <!-- Payment Options Section (Shows after form submission) -->
                    <div id="paymentSection" style="display: none;">
                        <h4 class="text-center mb-4">
                            <i class="fas fa-credit-card me-2"></i>Choose Your Payment Method
                        </h4>
                        
                        <div class="alert alert-success mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>Service:</strong> <span id="paymentServiceName"></span><br>
                                    <small class="text-muted">Consultation details saved</small>
                                </div>
                                <div class="text-end">
                                    <div class="h3 mb-0 text-success" id="paymentTotal"></div>
                                    <small class="text-muted">Total Amount</small>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Method Cards -->
                        <div class="row g-3 mb-4">
                            <!-- PayPal -->
                            <div class="col-md-4">
                                <div class="card h-100 border-2 border-primary shadow-sm payment-option" onclick="selectPaymentMethod('paypal')" style="cursor: pointer;">
                                    <div class="card-body text-center py-4">
                                        <i class="fab fa-paypal text-primary mb-3" style="font-size: 3rem;"></i>
                                        <h5 class="card-title">PayPal</h5>
                                        <p class="card-text small text-muted">Fast & secure PayPal payment</p>
                                        <div class="badge bg-success">Most Popular</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Credit Card -->
                            <div class="col-md-4">
                                <div class="card h-100 border-2 shadow-sm payment-option" onclick="selectPaymentMethod('card')" style="cursor: pointer;">
                                    <div class="card-body text-center py-4">
                                        <i class="fas fa-credit-card text-info mb-3" style="font-size: 3rem;"></i>
                                        <h5 class="card-title">Credit Card</h5>
                                        <p class="card-text small text-muted">Visa, Mastercard, Amex</p>
                                        <div class="badge bg-info">Instant</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Stripe -->
                            <div class="col-md-4">
                                <div class="card h-100 border-2 shadow-sm payment-option" onclick="selectPaymentMethod('stripe')" style="cursor: pointer;">
                                    <div class="card-body text-center py-4">
                                        <i class="fab fa-stripe text-purple mb-3" style="font-size: 3rem;"></i>
                                        <h5 class="card-title">Stripe</h5>
                                        <p class="card-text small text-muted">Secure Stripe checkout</p>
                                        <div class="badge bg-secondary">Secure</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hidden Payment Forms -->
                        <div id="paypalForm" class="payment-form" style="display: none;">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                You will be redirected to PayPal to complete your payment securely.
                            </div>
                            <button onclick="processPayment('paypal')" class="btn btn-primary btn-lg w-100">
                                <i class="fab fa-paypal me-2"></i>Pay with PayPal
                            </button>
                        </div>

                        <div id="cardForm" class="payment-form" style="display: none;">
                            <div class="card border-0 bg-light p-4">
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Card Number</label>
                                    <input type="text" class="form-control form-control-lg" placeholder="1234 5678 9012 3456" maxlength="19">
                                </div>
                                <div class="row g-3 mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Expiry Date</label>
                                        <input type="text" class="form-control form-control-lg" placeholder="MM/YY" maxlength="5">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">CVV</label>
                                        <input type="text" class="form-control form-control-lg" placeholder="123" maxlength="4">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold">Cardholder Name</label>
                                    <input type="text" class="form-control form-control-lg" placeholder="John Doe">
                                </div>
                            </div>
                            <button onclick="processPayment('card')" class="btn btn-info btn-lg w-100 mt-3">
                                <i class="fas fa-lock me-2"></i>Pay Securely
                            </button>
                        </div>

                        <div id="stripeForm" class="payment-form" style="display: none;">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                You will be redirected to Stripe's secure checkout page.
                            </div>
                            <button onclick="processPayment('stripe')" class="btn btn-secondary btn-lg w-100">
                                <i class="fab fa-stripe me-2"></i>Pay with Stripe
                            </button>
                        </div>

                        <div class="text-center mt-4">
                            <button onclick="backToForm()" class="btn btn-link text-muted">
                                <i class="fas fa-arrow-left me-2"></i>Back to Form
                            </button>
                        </div>
                    </div>

                    <!-- Payment Success -->
                    <div id="paymentSuccess" class="text-center" style="display: none;">
                        <div class="mb-4">
                            <i class="fas fa-check-circle text-success" style="font-size: 5rem;"></i>
                        </div>
                        <h3 class="text-success mb-3">Payment Successful!</h3>
                        <p class="lead mb-4">Thank you for your purchase!</p>
                        <div class="alert alert-success text-start">
                            <h5 class="alert-heading">What happens next?</h5>
                            <ol class="mb-0">
                                <li>You'll receive a confirmation email within 5 minutes</li>
                                <li>A proposal specialist will contact you within 24 hours</li>
                                <li>We'll schedule your consultation at your convenience</li>
                                <li>Upload your proposal documents via the secure link provided</li>
                            </ol>
                        </div>
                        <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                            <a href="{{ url_for('customer_dashboard') }}" class="btn btn-primary btn-lg">
                                <i class="fas fa-tachometer-alt me-2"></i>Go to Dashboard
                            </a>
                            <a href="{{ url_for('customer_leads') }}" class="btn btn-outline-primary btn-lg">
                                <i class="fas fa-list me-2"></i>View My Leads
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Important Disclaimer -->
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="alert alert-warning border-warning shadow-sm">
                <h5 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Important Disclaimer</h5>
                <p class="mb-2"><strong>No Guarantee of Contract Award:</strong> Our proposal support services provide expert guidance, review, and recommendations to improve your proposal quality and compliance. However, we cannot and do not guarantee that your proposal will be selected or that you will win the contract.</p>
                <p class="mb-2"><strong>Success Depends on Multiple Factors:</strong> Contract awards are determined by government evaluators based on technical approach, pricing, past performance, and other evaluation criteria specific to each solicitation. Many factors beyond proposal quality affect award decisions.</p>
                <p class="mb-0"><strong>Your Responsibility:</strong> You are ultimately responsible for the accuracy, completeness, and compliance of your proposal submissions. Our services provide support and recommendations, but final decisions and submissions remain your responsibility.</p>
            </div>
        </div>
    </div>
</div>

<script>
// Global variables to store consultation data
let consultationData = {};

function selectServiceLevel(level) {
    const serviceLevel = level;
    const serviceName = level === 'standard' ? 'Standard Review' : 'Premium Consultation';
    const basePrice = level === 'standard' ? 299 : 599;
    
    // Set form values
    document.getElementById('serviceLevel').value = serviceLevel;
    document.getElementById('basePrice').value = basePrice;
    
    // Show selected service
    const display = document.getElementById('selectedServiceDisplay');
    display.classList.remove('d-none');
    document.getElementById('selectedServiceName').textContent = serviceName;
    document.getElementById('selectedServicePrice').textContent = '$' + basePrice;
    
    // Scroll to form smoothly
    const formSection = document.getElementById('consultationFormSection');
    formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    
    // Update total
    setTimeout(() => {
        updateEstimatedTotal();
        // Highlight the form
        formSection.style.border = '3px solid #0d6efd';
        formSection.style.borderRadius = '10px';
        setTimeout(() => {
            formSection.style.border = '';
        }, 2000);
    }, 500);
}

function updateEstimatedTotal() {
    const basePrice = parseInt(document.getElementById('basePrice').value) || 0;
    let total = basePrice;
    
    // Add-ons
    if (document.getElementById('addBranding') && document.getElementById('addBranding').checked) {
        total += 149;
    }
    if (document.getElementById('addMarketing') && document.getElementById('addMarketing').checked) {
        total += 199;
    }
    
    document.getElementById('estimatedTotal').textContent = '$' + total.toFixed(0);
    return total;
}

// Update total when add-ons change
document.addEventListener('DOMContentLoaded', function() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"][name^="add"]');
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', updateEstimatedTotal);
    });
});

function submitConsultation(event) {
    event.preventDefault();
    
    // Validate service level is selected
    const serviceLevel = document.getElementById('serviceLevel').value;
    if (!serviceLevel) {
        alert('Please select a service level (Standard Review or Premium Consultation) above.');
        window.scrollTo({ top: 0, behavior: 'smooth' });
        return;
    }
    
    const formData = new FormData(event.target);
    consultationData = Object.fromEntries(formData);
    consultationData.totalAmount = updateEstimatedTotal();
    
    // Store in session/backend
    fetch('/api/consultation-request', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(consultationData)
    })
    .then(response => response.json())
    .then(result => {
        // Hide form, show payment options
        document.getElementById('consultationForm').style.display = 'none';
        document.getElementById('paymentSection').style.display = 'block';
        
        // Update payment section with details
        const serviceName = serviceLevel === 'standard' ? 'Standard Review ($299)' : 'Premium Consultation ($599)';
        document.getElementById('paymentServiceName').textContent = serviceName;
        document.getElementById('paymentTotal').textContent = '$' + consultationData.totalAmount;
        
        // Scroll to payment section
        document.getElementById('paymentSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    })
    .catch(error => {
        console.error('Error:', error);
        // Still show payment on error for demo purposes
        document.getElementById('consultationForm').style.display = 'none';
        document.getElementById('paymentSection').style.display = 'block';
        
        const serviceName = serviceLevel === 'standard' ? 'Standard Review ($299)' : 'Premium Consultation ($599)';
        document.getElementById('paymentServiceName').textContent = serviceName;
        document.getElementById('paymentTotal').textContent = '$' + consultationData.totalAmount;
        
        document.getElementById('paymentSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
}

function selectPaymentMethod(method) {
    // Hide all payment forms
    document.querySelectorAll('.payment-form').forEach(form => {
        form.style.display = 'none';
    });
    
    // Remove active state from all cards
    document.querySelectorAll('.payment-option').forEach(card => {
        card.classList.remove('border-success');
        card.classList.add('border-2');
    });
    
    // Show selected payment form
    const selectedCard = event.currentTarget;
    selectedCard.classList.add('border-success');
    selectedCard.classList.remove('border-2');
    selectedCard.classList.add('border-3');
    
    if (method === 'paypal') {
        document.getElementById('paypalForm').style.display = 'block';
    } else if (method === 'card') {
        document.getElementById('cardForm').style.display = 'block';
    } else if (method === 'stripe') {
        document.getElementById('stripeForm').style.display = 'block';
    }
    
    // Scroll to payment form
    setTimeout(() => {
        const form = document.querySelector('.payment-form[style*="display: block"]');
        if (form) {
            form.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }, 100);
}

function processPayment(method) {
    // Show loading state
    event.target.disabled = true;
    event.target.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
    
    // Simulate payment processing
    const paymentData = {
        ...consultationData,
        paymentMethod: method,
        amount: consultationData.totalAmount
    };
    
    // Send to backend
    fetch('/api/process-consultation-payment', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(paymentData)
    })
    .then(response => response.json())
    .then(result => {
        // Simulate payment processing delay
        setTimeout(() => {
            // Hide payment section
            document.getElementById('paymentSection').style.display = 'none';
            
            // Show success message
            document.getElementById('paymentSuccess').style.display = 'block';
            
            // Scroll to success
            document.getElementById('paymentSuccess').scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Optional: Redirect after a few seconds
            // setTimeout(() => {
            //     window.location.href = '/customer-dashboard';
            // }, 5000);
        }, 2000);
    })
    .catch(error => {
        console.error('Payment error:', error);
        // Show success anyway for demo
        setTimeout(() => {
            document.getElementById('paymentSection').style.display = 'none';
            document.getElementById('paymentSuccess').style.display = 'block';
            document.getElementById('paymentSuccess').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 2000);
    });
}

function backToForm() {
    document.getElementById('paymentSection').style.display = 'none';
    document.getElementById('consultationForm').style.display = 'block';
    document.getElementById('consultationForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
}
</script>

<style>
.payment-option {
    transition: all 0.3s ease;
    cursor: pointer;
}

.payment-option:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
}

.payment-option.border-success {
    animation: pulse-border 1.5s infinite;
}

@keyframes pulse-border {
    0%, 100% {
        box-shadow: 0 0 0 0 rgba(25, 135, 84, 0.4);
    }
    50% {
        box-shadow: 0 0 0 10px rgba(25, 135, 84, 0);
    }
}

.text-purple {
    color: #6772e5 !important;
}

#consultationFormSection {
    transition: border 0.3s ease;
}

.payment-form {
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

#paymentSuccess i.fa-check-circle {
    animation: scaleIn 0.5s ease;
}

@keyframes scaleIn {
    from {
        transform: scale(0);
    }
    to {
        transform: scale(1);
    }
}
</style>
{% endblock %}
